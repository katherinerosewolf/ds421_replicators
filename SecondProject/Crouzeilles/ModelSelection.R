#### Script provided by Renato Crouzeilles (International Institute for Sustainability) - renatocrouzeilles@gmail.com

#######################################################################################################################################################################
#######################################################################################################################################################################
## REFERENCE VS. RESTORED SYSTEMS

#######################################################################################################################################################################
## MAMMALS
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Mammals==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR, )
sort(outlyers$out) # 1.6094
data2<-subset(data2, data2$abRR<1.6094)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Metric+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
#coef<-list()
#r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m3<-glm(abRR~Disturbance+Metric+Ratio_5, data=data3, Gamma("identity"))
  m4<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m5<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m6<-glm(abRR~Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m9<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m10<-glm(abRR~Metric+LPS_5, data=data3, Gamma("identity"))
  m11<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Metric+LPS_5, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m14<-glm(abRR~Time+Metric, data=data3, Gamma("identity"))
  m15<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m16<-glm(abRR~Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m17<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m20<-glm(abRR~Disturbance+Metric+MPS_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Disturbance+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m26<-glm(abRR~Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m27<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Metric+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Disturbance+Metric+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Metric+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Disturbance+Metric+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Metric, data=data3, Gamma("identity"))
  m49<-glm(abRR~Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Metric+MPS_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Metric+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m65<-glm(abRR~Disturbance+Time+Metric, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m67<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m68<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Disturbance+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Disturbance+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~Disturbance+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Disturbance+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m89<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m91<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Metric, data=data3, Gamma("identity"))
  m94<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Time, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  #coef[[i]]<-list(summary(m))
  #r2[[i]]<-r.squaredLR(m, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink()
#sink("R2.txt") 
#lapply(r2, print) 
#sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

#######################################################################################################################################################################
## BIRDS
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Birds==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.0986
data2<-subset(data2, data2$abRR<1.0986)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Metric+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Metric, data=data3, Gamma("identity"))
  m6<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m9<-glm(abRR~Disturbance+Metric, data=data3, Gamma("identity"))
  m10<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m12<-glm(abRR~Activity+Metric, data=data3, Gamma("identity"))
  m13<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Time+Metric, data=data3, Gamma("identity"))
  m15<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Activity+Metric, data=data3, Gamma("identity"))
  m19<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m20<-glm(abRR~Disturbance+Time+Metric, data=data3, Gamma("identity"))
  m21<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m23<-glm(abRR~Activity+Time+Metric, data=data3, Gamma("identity"))
  m24<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m26<-glm(abRR~Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m27<-glm(abRR~Disturbance+Activity+Time+Metric, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m33<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Metric+Cover_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Disturbance+Metric+Cover_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Activity+Metric+Cover_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Activity+Metric+Cover_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Disturbance+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Activity+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Disturbance+Activity+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Metric+Iso_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Disturbance+Metric+Iso_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Activity+Metric+Iso_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+Activity+Metric+Iso_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Disturbance+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Activity+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Disturbance+Activity+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m97<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m98<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m99<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m100<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m101<-glm(abRR~Metric+Ratio_5, data=data3, Gamma("identity"))
  m102<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m103<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m104<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m105<-glm(abRR~Disturbance+Metric+Ratio_5, data=data3, Gamma("identity"))
  m106<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m107<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m108<-glm(abRR~Activity+Metric+Ratio_5, data=data3, Gamma("identity"))
  m109<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m110<-glm(abRR~Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m111<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m112<-glm(abRR~Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m113<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m114<-glm(abRR~Disturbance+Activity+Metric+Ratio_5, data=data3, Gamma("identity"))
  m115<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m116<-glm(abRR~Disturbance+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m117<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m118<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m119<-glm(abRR~Activity+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m120<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m121<-glm(abRR~Activity+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m122<-glm(abRR~Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m123<-glm(abRR~Disturbance+Activity+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m124<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m125<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m126<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m127<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m128<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m129<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m130<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m131<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m132<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m133<-glm(abRR~Metric+LPS_5, data=data3, Gamma("identity"))
  m134<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m135<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m136<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m137<-glm(abRR~Disturbance+Metric+LPS_5, data=data3, Gamma("identity"))
  m138<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m139<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m140<-glm(abRR~Activity+Metric+LPS_5, data=data3, Gamma("identity"))
  m141<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m142<-glm(abRR~Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m143<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m144<-glm(abRR~Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m145<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m146<-glm(abRR~Disturbance+Activity+Metric+LPS_5, data=data3, Gamma("identity"))
  m147<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m148<-glm(abRR~Disturbance+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m149<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m150<-glm(abRR~Disturbance+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m151<-glm(abRR~Activity+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m152<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m153<-glm(abRR~Activity+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m154<-glm(abRR~Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m155<-glm(abRR~Disturbance+Activity+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m156<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m157<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m158<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m159<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m160<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m161<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m162<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m163<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m164<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m165<-glm(abRR~Metric+MPS_5, data=data3, Gamma("identity"))
  m166<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m167<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m168<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m169<-glm(abRR~Disturbance+Metric+MPS_5, data=data3, Gamma("identity"))
  m170<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m171<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m172<-glm(abRR~Activity+Metric+MPS_5, data=data3, Gamma("identity"))
  m173<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m174<-glm(abRR~Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m175<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m176<-glm(abRR~Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m177<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m178<-glm(abRR~Disturbance+Activity+Metric+MPS_5, data=data3, Gamma("identity"))
  m179<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m180<-glm(abRR~Disturbance+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m181<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m182<-glm(abRR~Disturbance+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m183<-glm(abRR~Activity+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m184<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m185<-glm(abRR~Activity+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m186<-glm(abRR~Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m187<-glm(abRR~Disturbance+Activity+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m188<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m189<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m190<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m191<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m192<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96,m97,m98,m99,m100,m101,m102,m103,m104,m105,m106,m107,m108,m109,m110,m111,m112,m113,m114,m115,m116,m117,m118,m119,m120,m121,m122,m123,m124,m125,m126,m127,m128,m129,m130,m131,m132,m133,m134,m135,m136,m137,m138,m139,m140,m141,m142,m143,m144,m145,m146,m147,m148,m149,m150,m151,m152,m153,m154,m155,m156,m157,m158,m159,m160,m161,m162,m163,m164,m165,m166,m167,m168,m169,m170,m171,m172,m173,m174,m175,m176,m177,m178,m179,m180,m181,m182,m183,m184,m185,m186,m187,m188,m189,m190,m191,m192),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m5))
  r2[[i]]<-r.squaredLR(m5, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(r2[[i]][1])
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==5) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model - FACTORS
top_ranked_model.x<-as.data.frame(which(df_top_ranked[,7]==5)) 
write.table(top_ranked_model.x,"top_ranked_model.1.12.txt", sep="\t")
## Excel file - Example below

df1<-data.frame(coef[[2]][[1]][12])
df2<-data.frame(coef[[3]][[1]][12])
...

############## join coefs  
join<-rbind(df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97,df98,df99,df100) #,df101,df102,df103,df104,df105,df106,df107,df108,df109,df110,df111,df112,df113,df114,df115,df116,df117,df118,df119,df120,df121,df122,df123,df124,df125,df126,df127,df128,df129,df130,df131,df132,df133,df134,df135,df136,df137,df138,df139,df140,df141,df142,df143,df144,df145,df146,df147,df148,df149,df150,df151,df152,df153,df154,df155,df156,df157,df158,df159,df160,df161,df162,df163,df164,df165,df166,df167,df168,df169,df170,df171,df172,df173,df174,df175,df176,df177,df178,df179,df180,df181,df182,df183,df184,df185,df186,df187,df188,df189,df190,df191,df192,df193,df194,df195,df196,df197,df198,df199,df200,df201,df202,df203,df204,df205,df206,df207,df208,df209,df210,df211,df212,df213,df214,df215,df216,df217,df218,df219,df220,df221,df222,df223,df224,df225,df226,df227,df228,df229,df230,df231,df232,df233,df234,df235,df236,df237,df238,df239,df240,df241,df242,df243,df244,df245,df246,df247,df248,df249,df250,df251,df252,df253,df254,df255,df256,df257,df258,df259,df260,df261,df262,df263,df264,df265,df266,df267,df268,df269,df270,df271,df272,df273,df274,df275,df276,df277,df278,df279,df280,df281,df282,df283,df284,df285,df286,df287,df288,df289,df290,df291,df292,df293,df294,df295,df296,df297,df298,df299,df300,df301,df302,df303,df304,df305,df306,df307,df308,df309,df310,df311,df312,df313,df314,df315,df316,df317,df318,df319,df320,df321,df322,df323,df324,df325,df326,df327,df328,df329,df330,df331,df332,df333,df334,df335,df336,df337,df338,df339,df340,df341,df342,df343,df344,df345,df346,df347,df348,df349,df350,df351,df352,df353,df354,df355,df356,df357,df358,df359,df360,df361,df362,df363,df364,df365,df366,df367,df368,df369,df370,df371,df372,df373,df374,df375,df376,df377,df378,df379,df380,df381,df382,df383,df384,df385,df386,df387,df388,df389,df390,df391,df392,df393,df394,df395,df396,df397,df398,df399,df400,df401,df402,df403,df404,df405,df406,df407,df408,df409,df410,df411,df412,df413,df414,df415,df416,df417,df418,df419,df420,df421,df422,df423,df424,df425,df426,df427,df428,df429,df430,df431,df432,df433,df434,df435,df436,df437,df438,df439,df440,df441,df442,df443,df444,df445,df446,df447,df448,df449,df450,df451,df452,df453,df454,df455,df456,df457,df458,df459,df460,df461,df462,df463,df464,df465,df466,df467,df468,df469,df470,df471,df472,df473,df474,df475,df476,df477,df478,df479,df480,df481,df482,df483,df484,df485,df486,df487,df488,df489,df490,df491,df492,df493,df494,df495,df496,df497,df498,df499,df500,df501,df502,df503,df504,df505,df506,df507,df508,df509,df510,df511,df512,df513,df514,df515,df516,df517,df518,df519,df520,df521,df522,df523,df524,df525,df526,df527,df528,df529,df530,df531,df532,df533,df534,df535,df536,df537,df538,df539,df540,df541,df542,df543,df544,df545,df546,df547,df548,df549,df550,df551,df552,df553,df554,df555,df556,df557,df558,df559,df560,df561,df562,df563,df564,df565,df566,df567,df568,df569,df570,df571,df572,df573,df574,df575,df576,df577,df578,df579,df580,df581,df582,df583,df584,df585,df586,df587,df588,df589,df590,df591,df592,df593,df594,df595,df596,df597,df598,df599,df600)

#join2<-rbind(df601,df602,df603,df604,df605,df606,df607,df608,df609,df610,df611,df612,df613,df614,df615,df616,df617,df618,df619,df620,df621,df622,df623,df624,df625,df626,df627,df628,df629,df630,df631,df632,df633,df634,df635,df636,df637,df638,df639,df640,df641,df642,df643,df644,df645,df646,df647,df648,df649,df650,df651,df652,df653,df654,df655,df656,df657,df658,df659,df660,df661,df662,df663,df664,df665,df666,df667,df668,df669,df670,df671,df672,df673,df674,df675,df676,df677,df678,df679,df680,df681,df682,df683,df684,df685,df686,df687,df688,df689,df690,df691,df692,df693,df694,df695,df696,df697,df698,df699,df700,df701,df702,df703,df704,df705,df706,df707,df708,df709,df710,df711,df712,df713,df714,df715,df716,df717,df718,df719,df720,df721,df722,df723,df724,df725,df726,df727,df728,df729,df730,df731,df732,df733,df734,df735,df736,df737,df738,df739,df740,df741,df742,df743,df744,df745,df746,df747,df748,df749,df750,df751,df752,df753,df754,df755,df756,df757,df758,df759,df760,df761,df762,df763,df764,df765,df766,df767,df768,df769,df770,df771,df772,df773,df774,df775,df776,df777,df778,df779,df780,df781,df782,df783,df784,df785,df786,df787,df788,df789,df790,df791,df792,df793,df794,df795,df796,df797,df798,df799,df800,df801,df802,df803,df804,df805,df806,df807,df808,df809,df810,df811,df812,df813,df814,df815,df816,df817,df818,df819,df820,df821,df822,df823,df824,df825,df826,df827,df828,df829,df830,df831,df832,df833,df834,df835,df836,df837,df838,df839,df840,df841,df842,df843,df844,df845,df846,df847,df848,df849,df850,df851,df852,df853,df854,df855,df856,df857,df858,df859,df860,df861,df862,df863,df864,df865,df866,df867,df868,df869,df870,df871,df872,df873,df874,df875,df876,df877,df878,df879,df880,df881,df882,df883,df884,df885,df886,df887,df888,df889,df890,df891,df892,df893,df894,df895,df896,df897,df898,df899,df900,df901,df902,df903,df904,df905,df906,df907,df908,df909,df910,df911,df912,df913,df914,df915,df916,df917,df918,df919,df920,df921,df922,df923,df924,df925,df926,df927,df928,df929,df930,df931,df932,df933,df934,df935,df936,df937,df938,df939,df940,df941,df942,df943,df944,df945,df946,df947,df948,df949,df950,df951,df952,df953,df954,df955,df956,df957,df958,df959,df960,df961,df962,df963,df964,df965,df966,df967,df968,df969,df970,df971,df972,df973,df974,df975,df976,df977,df978,df979,df980,df981,df982,df983,df984,df985,df986,df987,df988,df989,df990,df991,df992,df993,df994,df995,df996,df997,df998,df999,df1000,df1001,df1002,df1003,df1004,df1005,df1006,df1007,df1008,df1009,df1010,df1011,df1012,df1013,df1014,df1015,df1016,df1017,df1018,df1019,df1020,df1021,df1022,df1023,df1024,df1025,df1026,df1027,df1028,df1029,df1030,df1031,df1032,df1033,df1034,df1035,df1036,df1037,df1038,df1039,df1040,df1041,df1042,df1043,df1044,df1045,df1046,df1047,df1048,df1049,df1050,df1051,df1052,df1053,df1054,df1055,df1056,df1057,df1058,df1059,df1060,df1061,df1062,df1063,df1064,df1065,df1066,df1067,df1068,df1069,df1070,df1071,df1072,df1073,df1074,df1075,df1076,df1077,df1078,df1079,df1080,df1081,df1082,df1083,df1084,df1085,df1086,df1087,df1088,df1089,df1090,df1091,df1092,df1093,df1094,df1095,df1096,df1097,df1098,df1099,df1100,df1101,df1102,df1103,df1104,df1105,df1106,df1107,df1108,df1109,df1110,df1111,df1112,df1113,df1114,df1115,df1116,df1117,df1118,df1119,df1120,df1121,df1122,df1123,df1124,df1125,df1126,df1127,df1128,df1129,df1130,df1131,df1132,df1133,df1134,df1135,df1136,df1137,df1138,df1139,df1140,df1141,df1142,df1143,df1144,df1145,df1146,df1147,df1148,df1149,df1150,df1151,df1152,df1153,df1154,df1155,df1156,df1157,df1158,df1159,df1160,df1161,df1162,df1163,df1164,df1165,df1166,df1167,df1168,df1169,df1170,df1171,df1172,df1173,df1174,df1175,df1176,df1177,df1178,df1179,df1180,df1181,df1182,df1183,df1184,df1185,df1186,df1187,df1188,df1189,df1190,df1191,df1192,df1193,df1194,df1195,df1196,df1197,df1198,df1199,df1200)

#join3<-rbind(df1201,df1202,df1203,df1204,df1205,df1206,df1207,df1208,df1209,df1210,df1211,df1212,df1213,df1214,df1215,df1216,df1217,df1218,df1219,df1220,df1221,df1222,df1223,df1224,df1225,df1226,df1227,df1228,df1229,df1230,df1231,df1232,df1233,df1234,df1235,df1236,df1237,df1238,df1239,df1240,df1241,df1242,df1243,df1244,df1245,df1246,df1247,df1248,df1249,df1250,df1251,df1252,df1253,df1254,df1255,df1256,df1257,df1258,df1259,df1260,df1261,df1262,df1263,df1264,df1265,df1266,df1267,df1268,df1269,df1270,df1271,df1272,df1273,df1274,df1275,df1276,df1277,df1278,df1279,df1280,df1281,df1282,df1283,df1284,df1285,df1286,df1287,df1288,df1289,df1290,df1291,df1292,df1293,df1294,df1295,df1296,df1297,df1298,df1299,df1300,df1301,df1302,df1303,df1304,df1305,df1306,df1307,df1308,df1309,df1310,df1311,df1312,df1313,df1314,df1315,df1316,df1317,df1318,df1319,df1320,df1321,df1322,df1323,df1324,df1325,df1326,df1327,df1328,df1329,df1330,df1331,df1332,df1333,df1334,df1335,df1336,df1337,df1338,df1339,df1340,df1341,df1342,df1343,df1344,df1345,df1346,df1347,df1348,df1349,df1350,df1351,df1352,df1353,df1354,df1355,df1356,df1357,df1358,df1359,df1360,df1361,df1362,df1363,df1364,df1365,df1366,df1367,df1368,df1369,df1370,df1371,df1372,df1373,df1374,df1375,df1376,df1377,df1378,df1379,df1380,df1381,df1382,df1383,df1384,df1385,df1386,df1387,df1388,df1389,df1390,df1391,df1392,df1393,df1394,df1395,df1396,df1397,df1398,df1399,df1400,df1401,df1402,df1403,df1404,df1405,df1406,df1407,df1408,df1409,df1410,df1411,df1412,df1413,df1414,df1415,df1416,df1417,df1418,df1419,df1420,df1421,df1422,df1423,df1424,df1425,df1426,df1427,df1428,df1429,df1430,df1431,df1432,df1433,df1434,df1435,df1436,df1437,df1438,df1439,df1440,df1441,df1442,df1443,df1444,df1445,df1446,df1447,df1448,df1449,df1450,df1451,df1452,df1453,df1454,df1455,df1456,df1457,df1458,df1459,df1460,df1461,df1462,df1463,df1464,df1465,df1466,df1467,df1468,df1469,df1470,df1471,df1472,df1473,df1474,df1475,df1476,df1477,df1478,df1479,df1480,df1481,df1482,df1483,df1484,df1485,df1486,df1487,df1488,df1489,df1490,df1491,df1492,df1493,df1494,df1495,df1496,df1497,df1498,df1499,df1500,df1501,df1502,df1503,df1504,df1505,df1506,df1507,df1508,df1509,df1510,df1511,df1512,df1513,df1514,df1515,df1516,df1517,df1518,df1519,df1520,df1521,df1522,df1523,df1524,df1525,df1526,df1527,df1528,df1529,df1530,df1531,df1532,df1533,df1534,df1535,df1536,df1537,df1538,df1539,df1540,df1541,df1542,df1543,df1544,df1545,df1546,df1547,df1548,df1549,df1550,df1551,df1552,df1553,df1554,df1555,df1556,df1557,df1558,df1559,df1560,df1561,df1562,df1563,df1564,df1565,df1566,df1567,df1568,df1569,df1570,df1571,df1572,df1573,df1574,df1575,df1576,df1577,df1578,df1579,df1580,df1581,df1582,df1583,df1584,df1585,df1586,df1587,df1588,df1589,df1590,df1591,df1592,df1593,df1594,df1595,df1596,df1597,df1598,df1599,df1600,df1601,df1602,df1603,df1604,df1605,df1606,df1607,df1608,df1609,df1610,df1611,df1612,df1613,df1614,df1615,df1616,df1617,df1618,df1619,df1620,df1621,df1622,df1623,df1624,df1625,df1626,df1627,df1628,df1629,df1630,df1631,df1632,df1633,df1634,df1635,df1636,df1637,df1638,df1639,df1640,df1641,df1642,df1643,df1644,df1645,df1646,df1647,df1648,df1649,df1650,df1651,df1652,df1653,df1654,df1655,df1656,df1657,df1658,df1659,df1660,df1661,df1662,df1663,df1664,df1665,df1666,df1667,df1668,df1669,df1670,df1671,df1672,df1673,df1674,df1675,df1676,df1677,df1678,df1679,df1680,df1681,df1682,df1683,df1684,df1685,df1686,df1687,df1688,df1689,df1690,df1691,df1692,df1693,df1694,df1695,df1696,df1697,df1698,df1699,df1700)

#join4<-rbind(df1701,df1702,df1703,df1704,df1705,df1706,df1707,df1708,df1709,df1710,df1711,df1712,df1713,df1714,df1715,df1716,df1717,df1718,df1719,df1720,df1721,df1722,df1723,df1724,df1725,df1726,df1727,df1728,df1729,df1730,df1731,df1732,df1733,df1734,df1735,df1736,df1737,df1738,df1739,df1740,df1741,df1742,df1743,df1744,df1745,df1746,df1747,df1748,df1749,df1750,df1751,df1752,df1753,df1754,df1755,df1756,df1757,df1758,df1759,df1760,df1761,df1762,df1763,df1764,df1765,df1766,df1767,df1768,df1769,df1770,df1771,df1772,df1773,df1774,df1775,df1776,df1777,df1778,df1779,df1780,df1781,df1782,df1783,df1784,df1785,df1786,df1787,df1788,df1789,df1790,df1791,df1792,df1793,df1794,df1795,df1796,df1797,df1798,df1799,df1800,df1801,df1802,df1803,df1804,df1805,df1806,df1807,df1808,df1809,df1810,df1811,df1812,df1813,df1814,df1815,df1816,df1817,df1818,df1819,df1820,df1821,df1822,df1823,df1824,df1825,df1826,df1827,df1828,df1829,df1830,df1831,df1832,df1833,df1834,df1835,df1836,df1837,df1838,df1839,df1840,df1841,df1842,df1843,df1844,df1845,df1846,df1847,df1848,df1849,df1850,df1851,df1852,df1853,df1854,df1855,df1856,df1857,df1858,df1859,df1860,df1861,df1862,df1863,df1864,df1865,df1866,df1867,df1868,df1869,df1870,df1871,df1872,df1873,df1874,df1875,df1876,df1877,df1878,df1879,df1880,df1881,df1882,df1883,df1884,df1885,df1886,df1887,df1888,df1889,df1890,df1891,df1892,df1893,df1894,df1895,df1896,df1897,df1898,df1899,df1900,df1901,df1902,df1903,df1904,df1905)

coef_plausible_model<-rbind(join) #, join2,join3,join4)   
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
## Mean using excel by removing numbers from the first column

#######################################################################################################################################################################
## INVERTEBRATES
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Invertebrates==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.9459
data2<-subset(data2, data2$abRR<1.9459)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Metric+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Metric, data=data3, Gamma("identity"))
  m6<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m9<-glm(abRR~Disturbance+Metric, data=data3, Gamma("identity"))
  m10<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m12<-glm(abRR~Activity+Metric, data=data3, Gamma("identity"))
  m13<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Time+Metric, data=data3, Gamma("identity"))
  m15<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Activity+Metric, data=data3, Gamma("identity"))
  m19<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m20<-glm(abRR~Disturbance+Time+Metric, data=data3, Gamma("identity"))
  m21<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m23<-glm(abRR~Activity+Time+Metric, data=data3, Gamma("identity"))
  m24<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m26<-glm(abRR~Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m27<-glm(abRR~Disturbance+Activity+Time+Metric, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m33<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Metric+Cover_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Disturbance+Metric+Cover_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Activity+Metric+Cover_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Activity+Metric+Cover_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Disturbance+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Activity+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Disturbance+Activity+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Metric+Iso_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Disturbance+Metric+Iso_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Activity+Metric+Iso_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+Activity+Metric+Iso_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Disturbance+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Activity+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Disturbance+Activity+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m97<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m98<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m99<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m100<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m101<-glm(abRR~Metric+Ratio_5, data=data3, Gamma("identity"))
  m102<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m103<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m104<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m105<-glm(abRR~Disturbance+Metric+Ratio_5, data=data3, Gamma("identity"))
  m106<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m107<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m108<-glm(abRR~Activity+Metric+Ratio_5, data=data3, Gamma("identity"))
  m109<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m110<-glm(abRR~Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m111<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m112<-glm(abRR~Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m113<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m114<-glm(abRR~Disturbance+Activity+Metric+Ratio_5, data=data3, Gamma("identity"))
  m115<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m116<-glm(abRR~Disturbance+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m117<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m118<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m119<-glm(abRR~Activity+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m120<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m121<-glm(abRR~Activity+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m122<-glm(abRR~Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m123<-glm(abRR~Disturbance+Activity+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m124<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m125<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m126<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m127<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m128<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m129<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m130<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m131<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m132<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m133<-glm(abRR~Metric+LPS_5, data=data3, Gamma("identity"))
  m134<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m135<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m136<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m137<-glm(abRR~Disturbance+Metric+LPS_5, data=data3, Gamma("identity"))
  m138<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m139<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m140<-glm(abRR~Activity+Metric+LPS_5, data=data3, Gamma("identity"))
  m141<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m142<-glm(abRR~Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m143<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m144<-glm(abRR~Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m145<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m146<-glm(abRR~Disturbance+Activity+Metric+LPS_5, data=data3, Gamma("identity"))
  m147<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m148<-glm(abRR~Disturbance+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m149<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m150<-glm(abRR~Disturbance+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m151<-glm(abRR~Activity+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m152<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m153<-glm(abRR~Activity+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m154<-glm(abRR~Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m155<-glm(abRR~Disturbance+Activity+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m156<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m157<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m158<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m159<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m160<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m161<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m162<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m163<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m164<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m165<-glm(abRR~Metric+MPS_5, data=data3, Gamma("identity"))
  m166<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m167<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m168<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m169<-glm(abRR~Disturbance+Metric+MPS_5, data=data3, Gamma("identity"))
  m170<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m171<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m172<-glm(abRR~Activity+Metric+MPS_5, data=data3, Gamma("identity"))
  m173<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m174<-glm(abRR~Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m175<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m176<-glm(abRR~Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m177<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m178<-glm(abRR~Disturbance+Activity+Metric+MPS_5, data=data3, Gamma("identity"))
  m179<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m180<-glm(abRR~Disturbance+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m181<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m182<-glm(abRR~Disturbance+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m183<-glm(abRR~Activity+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m184<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m185<-glm(abRR~Activity+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m186<-glm(abRR~Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m187<-glm(abRR~Disturbance+Activity+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m188<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m189<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m190<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m191<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m192<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96,m97,m98,m99,m100,m101,m102,m103,m104,m105,m106,m107,m108,m109,m110,m111,m112,m113,m114,m115,m116,m117,m118,m119,m120,m121,m122,m123,m124,m125,m126,m127,m128,m129,m130,m131,m132,m133,m134,m135,m136,m137,m138,m139,m140,m141,m142,m143,m144,m145,m146,m147,m148,m149,m150,m151,m152,m153,m154,m155,m156,m157,m158,m159,m160,m161,m162,m163,m164,m165,m166,m167,m168,m169,m170,m171,m172,m173,m174,m175,m176,m177,m178,m179,m180,m181,m182,m183,m184,m185,m186,m187,m188,m189,m190,m191,m192),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m2))
  r2[[i]]<-r.squaredLR(m2, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(attr(r2[[i]],"adj.r.squared")) 
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==2) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model - FACTORS
top_ranked_model.x<-as.data.frame(which(df_top_ranked[,7]==2)) 
write.table(top_ranked_model.x,"top_ranked_model.1.12.txt", sep="\t")
## Excel file - Exemple below

df1<-data.frame(coef[[6]][[1]][12])
df2<-data.frame(coef[[10]][[1]][12])
...

############## join coefs  
join<-rbind(df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97,df98,df99,df100) #,df101,df102,df103,df104,df105,df106,df107,df108,df109,df110,df111,df112,df113,df114,df115,df116,df117,df118,df119,df120,df121,df122,df123,df124,df125,df126,df127,df128,df129,df130,df131,df132,df133,df134,df135,df136,df137,df138,df139,df140,df141,df142,df143,df144,df145,df146,df147,df148,df149,df150,df151,df152,df153,df154,df155,df156,df157,df158,df159,df160,df161,df162,df163,df164,df165,df166,df167,df168,df169,df170,df171,df172,df173,df174,df175,df176,df177,df178,df179,df180,df181,df182,df183,df184,df185,df186,df187,df188,df189,df190,df191,df192,df193,df194,df195,df196,df197,df198,df199,df200,df201,df202,df203,df204,df205,df206,df207,df208,df209,df210,df211,df212,df213,df214,df215,df216,df217,df218,df219,df220,df221,df222,df223,df224,df225,df226,df227,df228,df229,df230,df231,df232,df233,df234,df235,df236,df237,df238,df239,df240,df241,df242,df243,df244,df245,df246,df247,df248,df249,df250,df251,df252,df253,df254,df255,df256,df257,df258,df259,df260,df261,df262,df263,df264,df265,df266,df267,df268,df269,df270,df271,df272,df273,df274,df275,df276,df277,df278,df279,df280,df281,df282,df283,df284,df285,df286,df287,df288,df289,df290,df291,df292,df293,df294,df295,df296,df297,df298,df299,df300,df301,df302,df303,df304,df305,df306,df307,df308,df309,df310,df311,df312,df313,df314,df315,df316,df317,df318,df319,df320,df321,df322,df323,df324,df325,df326,df327,df328,df329,df330,df331,df332,df333,df334,df335,df336,df337,df338,df339,df340,df341,df342,df343,df344,df345,df346,df347,df348,df349,df350,df351,df352,df353,df354,df355,df356,df357,df358,df359,df360,df361,df362,df363,df364,df365,df366,df367,df368,df369,df370,df371,df372,df373,df374,df375,df376,df377,df378,df379,df380,df381,df382,df383,df384,df385,df386,df387,df388,df389,df390,df391,df392,df393,df394,df395,df396,df397,df398,df399,df400,df401,df402,df403,df404,df405,df406,df407,df408,df409,df410,df411,df412,df413,df414,df415,df416,df417,df418,df419,df420,df421,df422,df423,df424,df425,df426,df427,df428,df429,df430,df431,df432,df433,df434,df435,df436,df437,df438,df439,df440,df441,df442,df443,df444,df445,df446,df447,df448,df449,df450,df451,df452,df453,df454,df455,df456,df457,df458,df459,df460,df461,df462,df463,df464,df465,df466,df467,df468,df469,df470,df471,df472,df473,df474,df475,df476,df477,df478,df479,df480,df481,df482,df483,df484,df485,df486,df487,df488,df489,df490,df491,df492,df493,df494,df495,df496,df497,df498,df499,df500,df501,df502,df503,df504,df505,df506,df507,df508,df509,df510,df511,df512,df513,df514,df515,df516,df517,df518,df519,df520,df521,df522,df523,df524,df525,df526,df527,df528,df529,df530,df531,df532,df533,df534,df535,df536,df537,df538,df539,df540,df541,df542,df543,df544,df545,df546,df547,df548,df549,df550,df551,df552,df553,df554,df555,df556,df557,df558,df559,df560,df561,df562,df563,df564,df565,df566,df567,df568,df569,df570,df571,df572,df573,df574,df575,df576,df577,df578,df579,df580,df581,df582,df583,df584,df585,df586,df587,df588,df589,df590,df591,df592,df593,df594,df595,df596,df597,df598,df599,df600)

#join2<-rbind(df601,df602,df603,df604,df605,df606,df607,df608,df609,df610,df611,df612,df613,df614,df615,df616,df617,df618,df619,df620,df621,df622,df623,df624,df625,df626,df627,df628,df629,df630,df631,df632,df633,df634,df635,df636,df637,df638,df639,df640,df641,df642,df643,df644,df645,df646,df647,df648,df649,df650,df651,df652,df653,df654,df655,df656,df657,df658,df659,df660,df661,df662,df663,df664,df665,df666,df667,df668,df669,df670,df671,df672,df673,df674,df675,df676,df677,df678,df679,df680,df681,df682,df683,df684,df685,df686,df687,df688,df689,df690,df691,df692,df693,df694,df695,df696,df697,df698,df699,df700,df701,df702,df703,df704,df705,df706,df707,df708,df709,df710,df711,df712,df713,df714,df715,df716,df717,df718,df719,df720,df721,df722,df723,df724,df725,df726,df727,df728,df729,df730,df731,df732,df733,df734,df735,df736,df737,df738,df739,df740,df741,df742,df743,df744,df745,df746,df747,df748,df749,df750,df751,df752,df753,df754,df755,df756,df757,df758,df759,df760,df761,df762,df763,df764,df765,df766,df767,df768,df769,df770,df771,df772,df773,df774,df775,df776,df777,df778,df779,df780,df781,df782,df783,df784,df785,df786,df787,df788,df789,df790,df791,df792,df793,df794,df795,df796,df797,df798,df799,df800,df801,df802,df803,df804,df805,df806,df807,df808,df809,df810,df811,df812,df813,df814,df815,df816,df817,df818,df819,df820,df821,df822,df823,df824,df825,df826,df827,df828,df829,df830,df831,df832,df833,df834,df835,df836,df837,df838,df839,df840,df841,df842,df843,df844,df845,df846,df847,df848,df849,df850,df851,df852,df853,df854,df855,df856,df857,df858,df859,df860,df861,df862,df863,df864,df865,df866,df867,df868,df869,df870,df871,df872,df873,df874,df875,df876,df877,df878,df879,df880,df881,df882,df883,df884,df885,df886,df887,df888,df889,df890,df891,df892,df893,df894,df895,df896,df897,df898,df899,df900,df901,df902,df903,df904,df905,df906,df907,df908,df909,df910,df911,df912,df913,df914,df915,df916,df917,df918,df919,df920,df921,df922,df923,df924,df925,df926,df927,df928,df929,df930,df931,df932,df933,df934,df935,df936,df937,df938,df939,df940,df941,df942,df943,df944,df945,df946,df947,df948,df949,df950,df951,df952,df953,df954,df955,df956,df957,df958,df959,df960,df961,df962,df963,df964,df965,df966,df967,df968,df969,df970,df971,df972,df973,df974,df975,df976,df977,df978,df979,df980,df981,df982,df983,df984,df985,df986,df987,df988,df989,df990,df991,df992,df993,df994,df995,df996,df997,df998,df999,df1000,df1001,df1002,df1003,df1004,df1005,df1006,df1007,df1008,df1009,df1010,df1011,df1012,df1013,df1014,df1015,df1016,df1017,df1018,df1019,df1020,df1021,df1022,df1023,df1024,df1025,df1026,df1027,df1028,df1029,df1030,df1031,df1032,df1033,df1034,df1035,df1036,df1037,df1038,df1039,df1040,df1041,df1042,df1043,df1044,df1045,df1046,df1047,df1048,df1049,df1050,df1051,df1052,df1053,df1054,df1055,df1056,df1057,df1058,df1059,df1060,df1061,df1062,df1063,df1064,df1065,df1066,df1067,df1068,df1069,df1070,df1071,df1072,df1073,df1074,df1075,df1076,df1077,df1078,df1079,df1080,df1081,df1082,df1083,df1084,df1085,df1086,df1087,df1088,df1089,df1090,df1091,df1092,df1093,df1094,df1095,df1096,df1097,df1098,df1099,df1100,df1101,df1102,df1103,df1104,df1105,df1106,df1107,df1108,df1109,df1110,df1111,df1112,df1113,df1114,df1115,df1116,df1117,df1118,df1119,df1120,df1121,df1122,df1123,df1124,df1125,df1126,df1127,df1128,df1129,df1130,df1131,df1132,df1133,df1134,df1135,df1136,df1137,df1138,df1139,df1140,df1141,df1142,df1143,df1144,df1145,df1146,df1147,df1148,df1149,df1150,df1151,df1152,df1153,df1154,df1155,df1156,df1157,df1158,df1159,df1160,df1161,df1162,df1163,df1164,df1165,df1166,df1167,df1168,df1169,df1170,df1171,df1172,df1173,df1174,df1175,df1176,df1177,df1178,df1179,df1180,df1181,df1182,df1183,df1184,df1185,df1186,df1187,df1188,df1189,df1190,df1191,df1192,df1193,df1194,df1195,df1196,df1197,df1198,df1199,df1200)

#join3<-rbind(df1201,df1202,df1203,df1204,df1205,df1206,df1207,df1208,df1209,df1210,df1211,df1212,df1213,df1214,df1215,df1216,df1217,df1218,df1219,df1220,df1221,df1222,df1223,df1224,df1225,df1226,df1227,df1228,df1229,df1230,df1231,df1232,df1233,df1234,df1235,df1236,df1237,df1238,df1239,df1240,df1241,df1242,df1243,df1244,df1245,df1246,df1247,df1248,df1249,df1250,df1251,df1252,df1253,df1254,df1255,df1256,df1257,df1258,df1259,df1260,df1261,df1262,df1263,df1264,df1265,df1266,df1267,df1268,df1269,df1270,df1271,df1272,df1273,df1274,df1275,df1276,df1277,df1278,df1279,df1280,df1281,df1282,df1283,df1284,df1285,df1286,df1287,df1288,df1289,df1290,df1291,df1292,df1293,df1294,df1295,df1296,df1297,df1298,df1299,df1300,df1301,df1302,df1303,df1304,df1305,df1306,df1307,df1308,df1309,df1310,df1311,df1312,df1313,df1314,df1315,df1316,df1317,df1318,df1319,df1320,df1321,df1322,df1323,df1324,df1325,df1326,df1327,df1328,df1329,df1330,df1331,df1332,df1333,df1334,df1335,df1336,df1337,df1338,df1339,df1340,df1341,df1342,df1343,df1344,df1345,df1346,df1347,df1348,df1349,df1350,df1351,df1352,df1353,df1354,df1355,df1356,df1357,df1358,df1359,df1360,df1361,df1362,df1363,df1364,df1365,df1366,df1367,df1368,df1369,df1370,df1371,df1372,df1373,df1374,df1375,df1376,df1377,df1378,df1379,df1380,df1381,df1382,df1383,df1384,df1385,df1386,df1387,df1388,df1389,df1390,df1391,df1392,df1393,df1394,df1395,df1396,df1397,df1398,df1399,df1400,df1401,df1402,df1403,df1404,df1405,df1406,df1407,df1408,df1409,df1410,df1411,df1412,df1413,df1414,df1415,df1416,df1417,df1418,df1419,df1420,df1421,df1422,df1423,df1424,df1425,df1426,df1427,df1428,df1429,df1430,df1431,df1432,df1433,df1434,df1435,df1436,df1437,df1438,df1439,df1440,df1441,df1442,df1443,df1444,df1445,df1446,df1447,df1448,df1449,df1450,df1451,df1452,df1453,df1454,df1455,df1456,df1457,df1458,df1459,df1460,df1461,df1462,df1463,df1464,df1465,df1466,df1467,df1468,df1469,df1470,df1471,df1472,df1473,df1474,df1475,df1476,df1477,df1478,df1479,df1480,df1481)

coef_plausible_model<-rbind(join) #,join2,join3)   
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
## Mean using excel by removing numbers from the first column

#######################################################################################################################################################################
## HERPETO
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Herpetofauna==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 2.0384
data2<-subset(data2, data2$abRR<2.0384)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Metric+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
#coef<-list()
#r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m3<-glm(abRR~Time, data=data3, Gamma("identity"))
  m4<-glm(abRR~Metric, data=data3, Gamma("identity"))
  m5<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m6<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m7<-glm(abRR~Activity+Metric, data=data3, Gamma("identity"))
  m8<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m9<-glm(abRR~Time+Metric, data=data3, Gamma("identity"))
  m10<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m12<-glm(abRR~Activity+Time+Metric, data=data3, Gamma("identity"))
  m13<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m15<-glm(abRR~Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m18<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m20<-glm(abRR~Metric+Cover_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Activity+Metric+Cover_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m26<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m27<-glm(abRR~Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Activity+Time+Metric+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Activity+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Metric+Iso_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Activity+Metric+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Activity+Time+Metric+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Activity+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Metric+Ratio_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Activity+Metric+Ratio_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Activity+Time+Metric+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Activity+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Metric+LPS_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Activity+Metric+LPS_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Activity+Time+Metric+LPS_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Activity+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Metric+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Activity+Metric+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Activity+Time+Metric+MPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Activity+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1")
  #coef[[i]]<-list()
  #r2[[i]]<-r.squaredLR(m, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
#sink("R2.txt") 
#lapply(r2, print) 
#sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

#######################################################################################################################################################################
## PLANTS
data<-read.table("Model_Selection_Landscape_10kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Plants==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.8031
data2<-subset(data2, data2$abRR<1.8031)

## Correlations
correlations<-subset(data2, select=Cover_10:Ratio_10)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_10,data2$Time, method="spearman")
cor(data2$Iso_10,data2$Time, method="spearman")
cor(data2$MPS_10,data2$Time, method="spearman")
cor(data2$LPS_10,data2$Time, method="spearman")
cor(data2$Ratio_10,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_10+Ratio_10+LPS_10+MPS_10+Iso_10, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1) 
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Metric, data=data3, Gamma("identity"))
  m6<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m9<-glm(abRR~Disturbance+Metric, data=data3, Gamma("identity"))
  m10<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m12<-glm(abRR~Activity+Metric, data=data3, Gamma("identity"))
  m13<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Time+Metric, data=data3, Gamma("identity"))
  m15<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Activity+Metric, data=data3, Gamma("identity"))
  m19<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m20<-glm(abRR~Disturbance+Time+Metric, data=data3, Gamma("identity"))
  m21<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m23<-glm(abRR~Activity+Time+Metric, data=data3, Gamma("identity"))
  m24<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m26<-glm(abRR~Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m27<-glm(abRR~Disturbance+Activity+Time+Metric, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm, data=data3, Gamma("identity"))
  m33<-glm(abRR~Cover_10, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Cover_10, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Cover_10, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Cover_10, data=data3, Gamma("identity"))
  m37<-glm(abRR~Metric+Cover_10, data=data3, Gamma("identity"))
  m38<-glm(abRR~Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Activity+Cover_10, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Time+Cover_10, data=data3, Gamma("identity"))
  m41<-glm(abRR~Disturbance+Metric+Cover_10, data=data3, Gamma("identity"))
  m42<-glm(abRR~Disturbance+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m43<-glm(abRR~Activity+Time+Cover_10, data=data3, Gamma("identity"))
  m44<-glm(abRR~Activity+Metric+Cover_10, data=data3, Gamma("identity"))
  m45<-glm(abRR~Activity+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m46<-glm(abRR~Time+Metric+Cover_10, data=data3, Gamma("identity"))
  m47<-glm(abRR~Time+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m48<-glm(abRR~Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m49<-glm(abRR~Disturbance+Activity+Time+Cover_10, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Activity+Metric+Cover_10, data=data3, Gamma("identity"))
  m51<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m52<-glm(abRR~Disturbance+Time+Metric+Cover_10, data=data3, Gamma("identity"))
  m53<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m55<-glm(abRR~Activity+Time+Metric+Cover_10, data=data3, Gamma("identity"))
  m56<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m58<-glm(abRR~Time+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m59<-glm(abRR~Disturbance+Activity+Time+Metric+Cover_10, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Cover_10, data=data3, Gamma("identity"))
  m65<-glm(abRR~Iso_10, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+Iso_10, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+Iso_10, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+Iso_10, data=data3, Gamma("identity"))
  m69<-glm(abRR~Metric+Iso_10, data=data3, Gamma("identity"))
  m70<-glm(abRR~Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Activity+Iso_10, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Time+Iso_10, data=data3, Gamma("identity"))
  m73<-glm(abRR~Disturbance+Metric+Iso_10, data=data3, Gamma("identity"))
  m74<-glm(abRR~Disturbance+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m75<-glm(abRR~Activity+Time+Iso_10, data=data3, Gamma("identity"))
  m76<-glm(abRR~Activity+Metric+Iso_10, data=data3, Gamma("identity"))
  m77<-glm(abRR~Activity+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m78<-glm(abRR~Time+Metric+Iso_10, data=data3, Gamma("identity"))
  m79<-glm(abRR~Time+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m80<-glm(abRR~Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m81<-glm(abRR~Disturbance+Activity+Time+Iso_10, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+Activity+Metric+Iso_10, data=data3, Gamma("identity"))
  m83<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m84<-glm(abRR~Disturbance+Time+Metric+Iso_10, data=data3, Gamma("identity"))
  m85<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m87<-glm(abRR~Activity+Time+Metric+Iso_10, data=data3, Gamma("identity"))
  m88<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m90<-glm(abRR~Time+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m91<-glm(abRR~Disturbance+Activity+Time+Metric+Iso_10, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Iso_10, data=data3, Gamma("identity"))
  m97<-glm(abRR~Ratio_10, data=data3, Gamma("identity"))
  m98<-glm(abRR~Disturbance+Ratio_10, data=data3, Gamma("identity"))
  m99<-glm(abRR~Activity+Ratio_10, data=data3, Gamma("identity"))
  m100<-glm(abRR~Time+Ratio_10, data=data3, Gamma("identity"))
  m101<-glm(abRR~Metric+Ratio_10, data=data3, Gamma("identity"))
  m102<-glm(abRR~Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m103<-glm(abRR~Disturbance+Activity+Ratio_10, data=data3, Gamma("identity"))
  m104<-glm(abRR~Disturbance+Time+Ratio_10, data=data3, Gamma("identity"))
  m105<-glm(abRR~Disturbance+Metric+Ratio_10, data=data3, Gamma("identity"))
  m106<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m107<-glm(abRR~Activity+Time+Ratio_10, data=data3, Gamma("identity"))
  m108<-glm(abRR~Activity+Metric+Ratio_10, data=data3, Gamma("identity"))
  m109<-glm(abRR~Activity+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m110<-glm(abRR~Time+Metric+Ratio_10, data=data3, Gamma("identity"))
  m111<-glm(abRR~Time+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m112<-glm(abRR~Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m113<-glm(abRR~Disturbance+Activity+Time+Ratio_10, data=data3, Gamma("identity"))
  m114<-glm(abRR~Disturbance+Activity+Metric+Ratio_10, data=data3, Gamma("identity"))
  m115<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m116<-glm(abRR~Disturbance+Time+Metric+Ratio_10, data=data3, Gamma("identity"))
  m117<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m118<-glm(abRR~Disturbance+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m119<-glm(abRR~Activity+Time+Metric+Ratio_10, data=data3, Gamma("identity"))
  m120<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m121<-glm(abRR~Activity+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m122<-glm(abRR~Time+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m123<-glm(abRR~Disturbance+Activity+Time+Metric+Ratio_10, data=data3, Gamma("identity"))
  m124<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m125<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m126<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m127<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m128<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+Ratio_10, data=data3, Gamma("identity"))
  m129<-glm(abRR~LPS_10, data=data3, Gamma("identity"))
  m130<-glm(abRR~Disturbance+LPS_10, data=data3, Gamma("identity"))
  m131<-glm(abRR~Activity+LPS_10, data=data3, Gamma("identity"))
  m132<-glm(abRR~Time+LPS_10, data=data3, Gamma("identity"))
  m133<-glm(abRR~Metric+LPS_10, data=data3, Gamma("identity"))
  m134<-glm(abRR~Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m135<-glm(abRR~Disturbance+Activity+LPS_10, data=data3, Gamma("identity"))
  m136<-glm(abRR~Disturbance+Time+LPS_10, data=data3, Gamma("identity"))
  m137<-glm(abRR~Disturbance+Metric+LPS_10, data=data3, Gamma("identity"))
  m138<-glm(abRR~Disturbance+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m139<-glm(abRR~Activity+Time+LPS_10, data=data3, Gamma("identity"))
  m140<-glm(abRR~Activity+Metric+LPS_10, data=data3, Gamma("identity"))
  m141<-glm(abRR~Activity+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m142<-glm(abRR~Time+Metric+LPS_10, data=data3, Gamma("identity"))
  m143<-glm(abRR~Time+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m144<-glm(abRR~Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m145<-glm(abRR~Disturbance+Activity+Time+LPS_10, data=data3, Gamma("identity"))
  m146<-glm(abRR~Disturbance+Activity+Metric+LPS_10, data=data3, Gamma("identity"))
  m147<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m148<-glm(abRR~Disturbance+Time+Metric+LPS_10, data=data3, Gamma("identity"))
  m149<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m150<-glm(abRR~Disturbance+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m151<-glm(abRR~Activity+Time+Metric+LPS_10, data=data3, Gamma("identity"))
  m152<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m153<-glm(abRR~Activity+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m154<-glm(abRR~Time+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m155<-glm(abRR~Disturbance+Activity+Time+Metric+LPS_10, data=data3, Gamma("identity"))
  m156<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m157<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m158<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m159<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m160<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+LPS_10, data=data3, Gamma("identity"))
  m161<-glm(abRR~MPS_10, data=data3, Gamma("identity"))
  m162<-glm(abRR~Disturbance+MPS_10, data=data3, Gamma("identity"))
  m163<-glm(abRR~Activity+MPS_10, data=data3, Gamma("identity"))
  m164<-glm(abRR~Time+MPS_10, data=data3, Gamma("identity"))
  m165<-glm(abRR~Metric+MPS_10, data=data3, Gamma("identity"))
  m166<-glm(abRR~Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m167<-glm(abRR~Disturbance+Activity+MPS_10, data=data3, Gamma("identity"))
  m168<-glm(abRR~Disturbance+Time+MPS_10, data=data3, Gamma("identity"))
  m169<-glm(abRR~Disturbance+Metric+MPS_10, data=data3, Gamma("identity"))
  m170<-glm(abRR~Disturbance+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m171<-glm(abRR~Activity+Time+MPS_10, data=data3, Gamma("identity"))
  m172<-glm(abRR~Activity+Metric+MPS_10, data=data3, Gamma("identity"))
  m173<-glm(abRR~Activity+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m174<-glm(abRR~Time+Metric+MPS_10, data=data3, Gamma("identity"))
  m175<-glm(abRR~Time+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m176<-glm(abRR~Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m177<-glm(abRR~Disturbance+Activity+Time+MPS_10, data=data3, Gamma("identity"))
  m178<-glm(abRR~Disturbance+Activity+Metric+MPS_10, data=data3, Gamma("identity"))
  m179<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m180<-glm(abRR~Disturbance+Time+Metric+MPS_10, data=data3, Gamma("identity"))
  m181<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m182<-glm(abRR~Disturbance+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m183<-glm(abRR~Activity+Time+Metric+MPS_10, data=data3, Gamma("identity"))
  m184<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m185<-glm(abRR~Activity+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m186<-glm(abRR~Time+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m187<-glm(abRR~Disturbance+Activity+Time+Metric+MPS_10, data=data3, Gamma("identity"))
  m188<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m189<-glm(abRR~Disturbance+Activity+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m190<-glm(abRR~Disturbance+Time+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m191<-glm(abRR~Activity+Time+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  m192<-glm(abRR~Disturbance+Activity+Time+Metric+Biogeographic_realm+MPS_10, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96,m97,m98,m99,m100,m101,m102,m103,m104,m105,m106,m107,m108,m109,m110,m111,m112,m113,m114,m115,m116,m117,m118,m119,m120,m121,m122,m123,m124,m125,m126,m127,m128,m129,m130,m131,m132,m133,m134,m135,m136,m137,m138,m139,m140,m141,m142,m143,m144,m145,m146,m147,m148,m149,m150,m151,m152,m153,m154,m155,m156,m157,m158,m159,m160,m161,m162,m163,m164,m165,m166,m167,m168,m169,m170,m171,m172,m173,m174,m175,m176,m177,m178,m179,m180,m181,m182,m183,m184,m185,m186,m187,m188,m189,m190,m191,m192),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m8))
  r2[[i]]<-r.squaredLR(m8, null = m1)
}


## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(attr(r2[[i]],"adj.r.squared")) 
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==8) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model
Coef_estimate<-list()
Coef_se<-list()
for(i in 1:100){
  coef<-coef
  df<-data.frame(coef[[i]][[1]][12]) 
  Coef_estimate[[i]]<-df[,1]
  Coef_se[[i]]<-df[,2]
}
df_Coef_estimate<-data.frame(matrix(unlist(Coef_estimate), nrow=100, byrow=T))
df_Coef_se<-data.frame(matrix(unlist(Coef_se), nrow=100, byrow=T))
Coef_estimate_se<-cbind(df_Coef_estimate,df_Coef_se)
coef_table<-cbind(df_top_ranked[,7],Coef_estimate_se)
coef_plausible_model<-subset(coef_table, coef_table[,1]==8) 
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
coef_plausible_model_mean<-as.data.frame(apply(coef_plausible_model, 2, mean))
write.table(coef_plausible_model_mean, "m.Coef_plausible_model_mean.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model - FACTORS
top_ranked_model.x<-as.data.frame(which(df_top_ranked[,7]==8)) 
write.table(top_ranked_model.x,"top_ranked_model.8.txt", sep="\t")
## Excel file - Example below

df1<-data.frame(coef[[1]][[1]][12])
df2<-data.frame(coef[[4]][[1]][12])
...

############## join coefs  
join<-rbind(df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97,df98,df99,df100) #,df101,df102,df103,df104,df105,df106,df107,df108,df109,df110,df111,df112,df113,df114,df115,df116,df117,df118,df119,df120,df121,df122,df123,df124,df125,df126,df127,df128,df129,df130,df131,df132,df133,df134,df135,df136,df137,df138,df139,df140,df141,df142,df143,df144,df145,df146,df147,df148,df149,df150,df151,df152,df153,df154,df155,df156,df157,df158,df159,df160,df161,df162,df163,df164,df165,df166,df167,df168,df169,df170,df171,df172,df173,df174,df175,df176,df177,df178,df179,df180,df181,df182,df183,df184,df185,df186,df187,df188,df189,df190,df191,df192,df193,df194,df195,df196,df197,df198,df199,df200,df201,df202,df203,df204,df205,df206,df207,df208,df209,df210,df211,df212,df213,df214,df215,df216,df217,df218,df219,df220,df221,df222,df223,df224,df225,df226,df227,df228,df229,df230,df231,df232,df233,df234,df235,df236,df237,df238,df239,df240,df241,df242,df243,df244,df245,df246,df247,df248,df249,df250,df251,df252,df253,df254,df255,df256,df257,df258,df259,df260,df261,df262,df263,df264,df265,df266,df267,df268,df269,df270,df271,df272,df273,df274,df275,df276,df277,df278,df279,df280,df281,df282,df283,df284,df285,df286,df287,df288,df289,df290,df291,df292,df293,df294,df295,df296,df297,df298,df299,df300,df301,df302,df303,df304,df305,df306,df307,df308,df309,df310,df311,df312,df313,df314,df315,df316,df317,df318,df319,df320,df321,df322,df323,df324,df325,df326,df327,df328,df329,df330,df331,df332,df333,df334,df335,df336,df337,df338,df339,df340,df341,df342,df343,df344,df345,df346,df347,df348,df349,df350,df351,df352,df353,df354,df355,df356,df357,df358,df359,df360,df361,df362,df363,df364,df365,df366,df367,df368,df369,df370,df371,df372,df373,df374,df375,df376,df377,df378,df379,df380,df381,df382,df383,df384,df385,df386,df387,df388,df389,df390,df391,df392,df393,df394,df395,df396,df397,df398,df399,df400,df401,df402,df403,df404,df405,df406,df407,df408,df409,df410,df411,df412,df413,df414,df415,df416,df417,df418,df419,df420,df421,df422,df423,df424,df425,df426,df427,df428,df429,df430,df431,df432,df433,df434,df435,df436,df437,df438,df439,df440,df441,df442,df443,df444,df445,df446,df447,df448,df449,df450,df451,df452,df453,df454,df455,df456,df457,df458,df459,df460,df461,df462,df463,df464,df465,df466,df467,df468,df469,df470,df471,df472,df473,df474,df475,df476,df477,df478,df479,df480,df481,df482,df483,df484,df485,df486,df487,df488,df489,df490,df491,df492,df493,df494,df495,df496,df497,df498,df499,df500,df501,df502,df503,df504,df505,df506,df507,df508,df509,df510,df511,df512,df513,df514,df515,df516,df517,df518,df519,df520,df521,df522,df523,df524,df525,df526,df527,df528,df529,df530,df531,df532,df533,df534,df535,df536,df537,df538,df539,df540,df541,df542,df543,df544,df545,df546,df547,df548,df549,df550,df551,df552,df553,df554,df555,df556,df557,df558,df559,df560,df561,df562,df563,df564,df565,df566,df567,df568,df569,df570,df571,df572,df573,df574,df575,df576,df577,df578,df579,df580,df581,df582,df583,df584,df585,df586,df587,df588,df589,df590,df591,df592,df593,df594,df595,df596,df597,df598,df599,df600)

#join2<-rbind(df601,df602,df603,df604,df605,df606,df607,df608,df609,df610,df611,df612,df613,df614,df615,df616,df617,df618,df619,df620,df621,df622,df623,df624,df625,df626,df627,df628,df629,df630,df631,df632,df633,df634,df635,df636,df637,df638,df639,df640,df641,df642,df643,df644,df645,df646,df647,df648,df649,df650,df651,df652,df653,df654,df655,df656,df657,df658,df659,df660,df661,df662,df663,df664,df665,df666,df667,df668,df669,df670,df671,df672,df673,df674,df675,df676,df677,df678,df679,df680,df681,df682,df683,df684,df685,df686,df687,df688,df689,df690,df691,df692,df693,df694,df695,df696,df697,df698,df699,df700,df701,df702,df703,df704,df705,df706,df707,df708,df709,df710,df711,df712,df713,df714,df715,df716,df717,df718,df719,df720,df721,df722,df723,df724,df725,df726,df727,df728,df729,df730,df731,df732,df733,df734,df735,df736,df737,df738,df739,df740,df741,df742,df743,df744,df745,df746,df747,df748,df749,df750,df751,df752,df753,df754,df755,df756,df757,df758,df759,df760,df761,df762,df763,df764,df765,df766,df767,df768,df769,df770,df771,df772,df773,df774,df775,df776,df777,df778,df779,df780,df781,df782,df783,df784,df785,df786,df787,df788,df789,df790,df791,df792,df793,df794,df795,df796,df797,df798,df799,df800,df801,df802,df803,df804,df805,df806,df807,df808,df809,df810,df811,df812,df813,df814,df815,df816,df817,df818,df819,df820,df821,df822,df823,df824,df825,df826,df827,df828,df829,df830,df831,df832,df833,df834,df835,df836,df837,df838,df839,df840,df841,df842,df843,df844,df845,df846,df847,df848,df849,df850,df851,df852,df853,df854,df855,df856,df857,df858,df859,df860,df861,df862,df863,df864,df865,df866,df867,df868,df869,df870,df871,df872,df873,df874,df875,df876,df877,df878,df879,df880,df881,df882,df883,df884,df885,df886,df887,df888,df889,df890,df891,df892,df893,df894,df895,df896,df897,df898,df899,df900,df901,df902,df903,df904,df905,df906,df907,df908,df909,df910,df911,df912,df913,df914,df915,df916,df917,df918,df919,df920,df921,df922,df923,df924,df925,df926,df927,df928,df929,df930,df931,df932,df933,df934,df935,df936,df937,df938,df939,df940,df941,df942,df943,df944,df945,df946,df947,df948,df949,df950,df951,df952,df953,df954,df955,df956,df957,df958,df959,df960,df961,df962,df963,df964,df965,df966,df967,df968,df969,df970,df971,df972,df973,df974,df975,df976,df977,df978,df979,df980,df981,df982,df983,df984,df985,df986,df987,df988,df989,df990,df991,df992,df993,df994,df995,df996,df997,df998,df999,df1000,df1001,df1002,df1003,df1004,df1005,df1006,df1007,df1008,df1009,df1010,df1011,df1012,df1013,df1014,df1015,df1016,df1017,df1018,df1019,df1020,df1021,df1022,df1023,df1024,df1025,df1026,df1027,df1028,df1029,df1030,df1031,df1032,df1033,df1034,df1035,df1036,df1037,df1038,df1039,df1040,df1041,df1042,df1043,df1044,df1045,df1046,df1047,df1048,df1049,df1050,df1051,df1052,df1053,df1054,df1055,df1056,df1057,df1058,df1059,df1060,df1061,df1062,df1063,df1064,df1065,df1066,df1067,df1068,df1069,df1070,df1071,df1072,df1073,df1074,df1075,df1076,df1077,df1078,df1079,df1080,df1081,df1082,df1083,df1084,df1085,df1086,df1087,df1088,df1089,df1090,df1091,df1092,df1093,df1094,df1095,df1096,df1097,df1098,df1099,df1100,df1101,df1102,df1103,df1104,df1105,df1106,df1107,df1108,df1109,df1110,df1111,df1112,df1113,df1114,df1115,df1116,df1117,df1118,df1119,df1120,df1121,df1122,df1123,df1124,df1125,df1126,df1127,df1128,df1129,df1130,df1131,df1132,df1133,df1134,df1135,df1136,df1137,df1138,df1139,df1140,df1141,df1142,df1143,df1144,df1145,df1146,df1147,df1148,df1149,df1150,df1151,df1152,df1153,df1154,df1155,df1156,df1157,df1158,df1159,df1160,df1161,df1162,df1163,df1164,df1165,df1166,df1167,df1168,df1169,df1170,df1171,df1172,df1173,df1174,df1175,df1176,df1177,df1178,df1179,df1180,df1181,df1182,df1183,df1184,df1185,df1186,df1187,df1188,df1189,df1190,df1191,df1192,df1193,df1194,df1195,df1196,df1197,df1198,df1199,df1200)

#join3<-rbind(df1201,df1202,df1203,df1204,df1205,df1206,df1207,df1208,df1209,df1210,df1211,df1212,df1213,df1214,df1215,df1216,df1217,df1218,df1219,df1220,df1221,df1222,df1223,df1224,df1225,df1226,df1227,df1228,df1229,df1230,df1231,df1232,df1233,df1234,df1235,df1236,df1237,df1238,df1239,df1240,df1241,df1242,df1243,df1244,df1245,df1246,df1247,df1248,df1249,df1250,df1251,df1252,df1253,df1254,df1255,df1256,df1257,df1258,df1259,df1260,df1261,df1262,df1263,df1264,df1265,df1266,df1267,df1268,df1269,df1270,df1271,df1272,df1273,df1274,df1275,df1276,df1277,df1278,df1279,df1280,df1281,df1282,df1283,df1284,df1285,df1286,df1287,df1288,df1289,df1290,df1291,df1292,df1293,df1294,df1295,df1296,df1297,df1298,df1299,df1300,df1301,df1302,df1303,df1304,df1305,df1306,df1307,df1308,df1309,df1310,df1311,df1312,df1313,df1314,df1315,df1316,df1317,df1318,df1319,df1320,df1321,df1322,df1323,df1324,df1325,df1326,df1327,df1328,df1329,df1330,df1331,df1332,df1333,df1334,df1335,df1336,df1337,df1338,df1339,df1340,df1341,df1342,df1343,df1344,df1345,df1346,df1347,df1348,df1349,df1350,df1351,df1352,df1353,df1354,df1355,df1356,df1357,df1358,df1359,df1360,df1361,df1362,df1363,df1364,df1365,df1366,df1367,df1368,df1369,df1370,df1371,df1372,df1373,df1374,df1375,df1376,df1377,df1378,df1379,df1380,df1381,df1382,df1383,df1384,df1385,df1386,df1387,df1388,df1389,df1390,df1391,df1392,df1393,df1394,df1395,df1396,df1397,df1398,df1399,df1400,df1401,df1402,df1403,df1404,df1405,df1406,df1407,df1408,df1409,df1410,df1411,df1412,df1413,df1414,df1415,df1416,df1417,df1418,df1419,df1420,df1421,df1422,df1423,df1424,df1425,df1426,df1427,df1428,df1429,df1430,df1431,df1432,df1433,df1434,df1435,df1436,df1437,df1438,df1439,df1440,df1441,df1442,df1443,df1444,df1445,df1446,df1447,df1448,df1449,df1450,df1451,df1452,df1453,df1454,df1455,df1456,df1457,df1458,df1459,df1460,df1461,df1462,df1463,df1464,df1465,df1466,df1467,df1468,df1469,df1470,df1471,df1472,df1473,df1474,df1475,df1476,df1477,df1478,df1479,df1480,df1481,df1482,df1483,df1484,df1485,df1486,df1487,df1488,df1489,df1490,df1491,df1492,df1493,df1494,df1495,df1496,df1497,df1498,df1499,df1500,df1501,df1502,df1503,df1504,df1505,df1506,df1507,df1508,df1509,df1510,df1511,df1512,df1513,df1514,df1515,df1516,df1517,df1518,df1519,df1520,df1521,df1522,df1523,df1524,df1525,df1526,df1527,df1528,df1529,df1530,df1531,df1532,df1533,df1534,df1535,df1536,df1537,df1538,df1539,df1540,df1541,df1542,df1543,df1544,df1545,df1546,df1547,df1548,df1549,df1550,df1551,df1552,df1553,df1554,df1555,df1556,df1557,df1558,df1559,df1560,df1561,df1562,df1563,df1564,df1565,df1566,df1567,df1568,df1569,df1570,df1571,df1572,df1573,df1574,df1575,df1576,df1577,df1578,df1579,df1580,df1581,df1582,df1583,df1584,df1585,df1586,df1587,df1588,df1589,df1590,df1591,df1592,df1593,df1594,df1595,df1596,df1597,df1598,df1599,df1600,df1601,df1602,df1603,df1604,df1605,df1606,df1607,df1608,df1609,df1610,df1611,df1612,df1613,df1614,df1615,df1616,df1617,df1618,df1619,df1620,df1621,df1622,df1623,df1624,df1625,df1626,df1627,df1628,df1629,df1630,df1631,df1632,df1633,df1634,df1635,df1636,df1637,df1638,df1639,df1640,df1641,df1642,df1643,df1644,df1645,df1646,df1647,df1648,df1649,df1650,df1651,df1652,df1653,df1654,df1655,df1656,df1657,df1658,df1659,df1660,df1661,df1662,df1663,df1664,df1665,df1666,df1667,df1668,df1669,df1670,df1671,df1672,df1673,df1674,df1675,df1676,df1677,df1678,df1679,df1680,df1681,df1682,df1683,df1684,df1685,df1686,df1687,df1688,df1689,df1690,df1691,df1692,df1693,df1694,df1695,df1696,df1697,df1698,df1699,df1700)

#join4<-rbind(df1701,df1702,df1703,df1704,df1705,df1706,df1707,df1708,df1709,df1710,df1711,df1712,df1713,df1714,df1715,df1716,df1717,df1718,df1719,df1720,df1721,df1722,df1723,df1724,df1725,df1726,df1727,df1728,df1729,df1730,df1731,df1732,df1733,df1734,df1735,df1736,df1737,df1738,df1739,df1740,df1741,df1742,df1743,df1744,df1745,df1746,df1747,df1748,df1749,df1750,df1751,df1752,df1753,df1754,df1755,df1756,df1757,df1758,df1759,df1760,df1761,df1762,df1763,df1764,df1765,df1766,df1767,df1768,df1769,df1770,df1771,df1772,df1773,df1774,df1775,df1776,df1777,df1778,df1779,df1780,df1781,df1782,df1783,df1784,df1785,df1786,df1787,df1788,df1789,df1790,df1791,df1792,df1793,df1794,df1795,df1796,df1797,df1798,df1799,df1800,df1801,df1802,df1803,df1804,df1805,df1806,df1807,df1808,df1809,df1810,df1811,df1812,df1813,df1814,df1815,df1816,df1817,df1818,df1819,df1820,df1821,df1822,df1823,df1824,df1825,df1826,df1827,df1828,df1829,df1830,df1831,df1832,df1833,df1834,df1835,df1836,df1837,df1838,df1839,df1840,df1841,df1842,df1843,df1844,df1845,df1846,df1847,df1848,df1849,df1850,df1851,df1852,df1853,df1854,df1855,df1856,df1857,df1858,df1859,df1860,df1861,df1862,df1863,df1864,df1865,df1866,df1867,df1868,df1869,df1870,df1871,df1872,df1873,df1874,df1875,df1876,df1877,df1878,df1879,df1880,df1881,df1882,df1883,df1884,df1885,df1886,df1887,df1888,df1889,df1890,df1891,df1892,df1893,df1894,df1895,df1896,df1897,df1898,df1899,df1900,df1901,df1902,df1903,df1904,df1905,df1906,df1907,df1908,df1909,df1910,df1911,df1912,df1913,df1914,df1915,df1916,df1917,df1918,df1919,df1920,df1921,df1922,df1923,df1924,df1925)

coef_plausible_model<-rbind(join) #,join2,join3,join4)   
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
## Mean using excel by removing numbers from the first column

#######################################################################################################################################################################
## BIOMASS
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Biomass==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 2.8984
data2<-subset(data2, data2$abRR<2.8984)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m6<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m9<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m10<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m15<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m20<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m26<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m27<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m7))
  r2[[i]]<-r.squaredLR(m7, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(attr(r2[[i]],"adj.r.squared")) 
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==7) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model
Coef_estimate<-list()
Coef_se<-list()
for(i in 1:100){
  coef<-coef
  df<-data.frame(coef[[i]][[1]][12]) 
  Coef_estimate[[i]]<-df[,1]
  Coef_se[[i]]<-df[,2]
}
df_Coef_estimate<-data.frame(matrix(unlist(Coef_estimate), nrow=100, byrow=T))
df_Coef_se<-data.frame(matrix(unlist(Coef_se), nrow=100, byrow=T))
Coef_estimate_se<-cbind(df_Coef_estimate,df_Coef_se)
coef_table<-cbind(df_top_ranked[,7],Coef_estimate_se)
coef_plausible_model<-subset(coef_table, coef_table[,1]==7) 
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
coef_plausible_model_mean<-as.data.frame(apply(coef_plausible_model, 2, mean))
write.table(coef_plausible_model_mean, "m.Coef_plausible_model_mean.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model - FACTORS
top_ranked_model.x<-as.data.frame(which(df_top_ranked[,7]==7)) 
write.table(top_ranked_model.x,"top_ranked_model.7.txt", sep="\t")
## Excel file - exemple below

df1<-data.frame(coef[[1]][[1]][12])
df2<-data.frame(coef[[7]][[1]][12])
...

############## join coefs  
join<-rbind(df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97,df98,df99,df100,df101,df102,df103,df104,df105,df106,df107,df108,df109,df110,df111,df112,df113,df114,df115,df116,df117,df118,df119,df120,df121,df122,df123,df124,df125,df126,df127,df128,df129,df130,df131,df132,df133,df134,df135,df136,df137,df138,df139,df140,df141,df142,df143,df144,df145,df146,df147,df148,df149,df150,df151,df152,df153,df154,df155,df156,df157,df158,df159,df160,df161,df162,df163,df164,df165,df166,df167,df168,df169,df170,df171,df172,df173,df174,df175,df176,df177,df178,df179,df180,df181,df182,df183,df184,df185,df186,df187,df188,df189,df190,df191,df192,df193,df194,df195,df196,df197,df198,df199,df200,df201,df202,df203,df204,df205,df206,df207,df208,df209,df210,df211,df212,df213,df214,df215,df216,df217,df218,df219,df220,df221,df222,df223,df224,df225,df226,df227,df228,df229,df230,df231,df232,df233,df234,df235,df236,df237,df238,df239,df240,df241,df242,df243,df244,df245,df246,df247,df248,df249,df250,df251,df252,df253,df254,df255,df256,df257,df258,df259,df260,df261,df262,df263,df264,df265,df266,df267,df268,df269,df270,df271,df272,df273,df274,df275,df276,df277,df278,df279,df280,df281,df282,df283,df284,df285,df286,df287,df288,df289,df290,df291,df292,df293,df294,df295,df296,df297,df298,df299,df300,df301,df302,df303,df304,df305,df306,df307,df308,df309,df310,df311,df312,df313,df314,df315,df316,df317,df318,df319,df320,df321,df322,df323,df324,df325,df326,df327,df328,df329,df330,df331,df332,df333,df334,df335,df336,df337,df338,df339,df340,df341,df342,df343,df344,df345,df346,df347,df348,df349,df350,df351,df352,df353,df354,df355,df356,df357,df358,df359,df360,df361,df362,df363,df364,df365,df366,df367,df368,df369,df370,df371,df372,df373,df374,df375,df376,df377,df378,df379,df380,df381,df382,df383,df384,df385,df386,df387,df388,df389,df390,df391,df392,df393,df394,df395,df396,df397,df398,df399,df400,df401,df402,df403,df404,df405,df406,df407,df408,df409,df410,df411,df412,df413,df414,df415,df416,df417,df418,df419,df420,df421,df422,df423,df424,df425,df426,df427,df428,df429,df430,df431,df432,df433,df434,df435,df436,df437,df438,df439,df440,df441,df442,df443,df444,df445,df446,df447,df448,df449,df450,df451,df452,df453,df454,df455,df456,df457,df458,df459,df460,df461,df462,df463,df464,df465,df466,df467,df468,df469,df470,df471,df472,df473,df474,df475,df476,df477,df478,df479,df480,df481,df482,df483,df484,df485,df486,df487,df488,df489,df490,df491,df492,df493,df494,df495,df496,df497,df498,df499,df500,df501,df502,df503,df504,df505,df506,df507,df508,df509,df510,df511,df512,df513,df514,df515,df516,df517,df518,df519,df520,df521,df522,df523,df524,df525,df526,df527,df528,df529,df530,df531,df532,df533,df534,df535,df536,df537,df538,df539,df540,df541,df542,df543,df544,df545,df546,df547,df548,df549,df550,df551,df552,df553,df554,df555,df556,df557,df558,df559,df560,df561,df562,df563,df564,df565,df566,df567,df568,df569,df570,df571,df572,df573,df574,df575,df576,df577,df578,df579,df580,df581,df582,df583,df584,df585,df586,df587,df588,df589,df590,df591,df592,df593,df594,df595,df596,df597,df598,df599,df600)

#join2<-rbind(df601,df602,df603,df604,df605,df606,df607,df608,df609,df610,df611,df612,df613,df614,df615,df616,df617,df618,df619,df620,df621,df622,df623,df624,df625,df626,df627,df628,df629,df630,df631,df632,df633,df634,df635,df636,df637,df638,df639,df640,df641,df642,df643,df644,df645,df646,df647,df648,df649,df650,df651,df652,df653,df654,df655,df656,df657,df658,df659,df660,df661,df662,df663,df664,df665,df666,df667,df668,df669,df670,df671,df672,df673,df674,df675,df676,df677,df678,df679,df680,df681,df682,df683,df684,df685,df686,df687,df688,df689,df690,df691,df692,df693,df694,df695,df696,df697,df698,df699,df700,df701,df702,df703,df704,df705,df706,df707,df708,df709,df710,df711,df712,df713,df714,df715,df716,df717,df718,df719,df720,df721,df722,df723,df724,df725,df726,df727,df728,df729,df730,df731,df732,df733,df734,df735,df736,df737,df738,df739,df740,df741,df742,df743,df744,df745,df746,df747,df748,df749,df750,df751,df752,df753,df754,df755,df756,df757,df758,df759,df760,df761,df762,df763,df764,df765,df766,df767,df768,df769,df770,df771,df772,df773,df774,df775,df776,df777,df778,df779,df780,df781,df782,df783,df784,df785,df786,df787,df788,df789,df790,df791,df792,df793,df794,df795,df796,df797,df798,df799,df800,df801,df802,df803,df804,df805,df806,df807,df808,df809,df810,df811,df812,df813,df814,df815,df816,df817,df818,df819,df820,df821,df822,df823,df824,df825,df826,df827,df828,df829,df830,df831,df832,df833,df834,df835,df836,df837,df838,df839,df840,df841,df842,df843,df844,df845,df846,df847,df848,df849,df850,df851,df852,df853,df854,df855,df856,df857,df858,df859,df860,df861,df862,df863,df864,df865,df866,df867,df868,df869,df870,df871,df872,df873,df874,df875,df876,df877,df878,df879,df880,df881,df882,df883,df884,df885,df886,df887,df888,df889,df890,df891,df892,df893,df894,df895,df896,df897,df898,df899,df900,df901,df902,df903,df904,df905,df906,df907,df908,df909,df910,df911,df912,df913,df914,df915,df916,df917,df918,df919,df920,df921,df922,df923,df924,df925,df926,df927,df928,df929,df930,df931,df932,df933,df934,df935,df936,df937,df938,df939,df940,df941,df942,df943,df944,df945,df946,df947,df948,df949,df950,df951,df952,df953,df954,df955,df956,df957,df958,df959,df960,df961,df962,df963,df964,df965,df966,df967,df968,df969,df970,df971,df972,df973,df974,df975,df976,df977,df978,df979,df980,df981,df982,df983,df984,df985,df986,df987,df988,df989,df990,df991,df992,df993,df994,df995,df996,df997,df998,df999,df1000,df1001,df1002,df1003,df1004,df1005,df1006,df1007,df1008,df1009,df1010,df1011,df1012,df1013,df1014,df1015,df1016,df1017,df1018,df1019,df1020,df1021,df1022,df1023,df1024,df1025,df1026,df1027,df1028,df1029,df1030,df1031,df1032,df1033,df1034,df1035,df1036,df1037,df1038,df1039,df1040,df1041,df1042,df1043,df1044,df1045,df1046,df1047,df1048,df1049,df1050,df1051,df1052,df1053,df1054,df1055,df1056,df1057,df1058,df1059,df1060,df1061,df1062,df1063,df1064,df1065,df1066,df1067,df1068,df1069,df1070,df1071,df1072,df1073,df1074,df1075,df1076,df1077,df1078,df1079,df1080,df1081,df1082,df1083,df1084,df1085,df1086,df1087,df1088,df1089,df1090,df1091,df1092,df1093,df1094,df1095,df1096,df1097,df1098,df1099,df1100,df1101,df1102,df1103,df1104,df1105,df1106,df1107,df1108,df1109,df1110,df1111,df1112,df1113,df1114,df1115,df1116,df1117,df1118,df1119,df1120,df1121,df1122,df1123,df1124,df1125,df1126,df1127,df1128,df1129,df1130,df1131,df1132,df1133,df1134,df1135,df1136,df1137,df1138,df1139,df1140,df1141,df1142,df1143,df1144,df1145,df1146,df1147,df1148,df1149,df1150,df1151,df1152,df1153,df1154,df1155,df1156,df1157,df1158,df1159,df1160,df1161,df1162,df1163,df1164,df1165,df1166,df1167,df1168,df1169,df1170,df1171,df1172,df1173,df1174,df1175,df1176,df1177,df1178,df1179,df1180,df1181,df1182,df1183,df1184,df1185,df1186,df1187,df1188,df1189,df1190,df1191,df1192,df1193,df1194,df1195,df1196,df1197,df1198,df1199,df1200)

#join3<-rbind(df1201,df1202,df1203,df1204,df1205,df1206,df1207,df1208,df1209,df1210,df1211,df1212,df1213,df1214,df1215,df1216,df1217,df1218,df1219,df1220,df1221,df1222,df1223,df1224,df1225,df1226,df1227,df1228,df1229,df1230,df1231,df1232,df1233,df1234,df1235,df1236,df1237,df1238,df1239,df1240,df1241,df1242,df1243,df1244,df1245,df1246,df1247,df1248,df1249,df1250,df1251,df1252,df1253,df1254,df1255,df1256,df1257,df1258,df1259,df1260,df1261,df1262,df1263,df1264,df1265,df1266,df1267,df1268,df1269,df1270,df1271,df1272,df1273,df1274,df1275,df1276,df1277,df1278,df1279,df1280,df1281,df1282,df1283,df1284,df1285,df1286,df1287,df1288,df1289,df1290,df1291,df1292,df1293,df1294,df1295,df1296,df1297,df1298,df1299,df1300,df1301,df1302,df1303,df1304,df1305,df1306,df1307,df1308,df1309,df1310,df1311,df1312,df1313,df1314,df1315,df1316,df1317,df1318,df1319,df1320,df1321,df1322,df1323,df1324,df1325,df1326,df1327,df1328,df1329,df1330,df1331,df1332,df1333,df1334,df1335,df1336,df1337,df1338,df1339,df1340,df1341,df1342,df1343,df1344,df1345,df1346,df1347,df1348,df1349,df1350,df1351,df1352,df1353,df1354,df1355,df1356,df1357,df1358,df1359,df1360,df1361,df1362,df1363,df1364,df1365,df1366,df1367,df1368,df1369,df1370,df1371,df1372,df1373,df1374,df1375,df1376,df1377,df1378,df1379,df1380,df1381,df1382,df1383,df1384,df1385,df1386,df1387,df1388,df1389,df1390,df1391,df1392,df1393,df1394,df1395,df1396,df1397,df1398,df1399,df1400,df1401,df1402,df1403,df1404,df1405,df1406,df1407,df1408,df1409,df1410,df1411,df1412,df1413,df1414,df1415,df1416,df1417,df1418,df1419,df1420,df1421,df1422,df1423,df1424,df1425,df1426,df1427,df1428,df1429,df1430,df1431,df1432,df1433,df1434,df1435,df1436,df1437,df1438,df1439,df1440,df1441,df1442,df1443,df1444,df1445,df1446,df1447,df1448,df1449,df1450,df1451,df1452,df1453,df1454,df1455,df1456,df1457,df1458,df1459,df1460,df1461,df1462,df1463,df1464,df1465,df1466,df1467,df1468,df1469,df1470,df1471,df1472,df1473,df1474,df1475,df1476,df1477,df1478,df1479,df1480,df1481,df1482,df1483,df1484,df1485,df1486,df1487,df1488,df1489,df1490,df1491,df1492,df1493,df1494,df1495,df1496,df1497,df1498,df1499,df1500,df1501,df1502,df1503,df1504,df1505,df1506,df1507,df1508,df1509,df1510,df1511,df1512,df1513,df1514,df1515,df1516,df1517,df1518,df1519,df1520,df1521,df1522,df1523,df1524,df1525,df1526,df1527,df1528,df1529,df1530,df1531,df1532,df1533,df1534,df1535,df1536,df1537,df1538,df1539,df1540,df1541,df1542,df1543,df1544,df1545,df1546,df1547,df1548,df1549,df1550,df1551,df1552,df1553,df1554,df1555,df1556,df1557,df1558,df1559,df1560,df1561,df1562,df1563,df1564,df1565,df1566,df1567,df1568,df1569,df1570,df1571,df1572,df1573,df1574,df1575,df1576,df1577,df1578,df1579,df1580,df1581,df1582,df1583,df1584,df1585,df1586,df1587,df1588,df1589,df1590,df1591,df1592,df1593,df1594,df1595,df1596,df1597,df1598,df1599,df1600,df1601,df1602,df1603,df1604,df1605,df1606,df1607,df1608,df1609,df1610,df1611,df1612,df1613,df1614,df1615,df1616,df1617,df1618,df1619,df1620,df1621,df1622,df1623,df1624,df1625,df1626,df1627,df1628,df1629,df1630,df1631,df1632,df1633,df1634,df1635,df1636,df1637,df1638,df1639,df1640,df1641,df1642,df1643,df1644,df1645,df1646,df1647,df1648,df1649,df1650,df1651,df1652,df1653,df1654,df1655,df1656,df1657,df1658,df1659,df1660,df1661,df1662,df1663,df1664,df1665,df1666,df1667,df1668,df1669,df1670,df1671,df1672,df1673,df1674,df1675,df1676,df1677,df1678,df1679,df1680,df1681,df1682,df1683,df1684,df1685,df1686,df1687,df1688,df1689,df1690,df1691,df1692,df1693,df1694,df1695,df1696,df1697,df1698,df1699,df1700)

#join4<-rbind(df1701,df1702,df1703,df1704,df1705,df1706,df1707,df1708,df1709,df1710,df1711,df1712,df1713,df1714,df1715,df1716,df1717,df1718,df1719,df1720,df1721,df1722,df1723,df1724,df1725,df1726,df1727,df1728,df1729,df1730,df1731,df1732,df1733,df1734,df1735,df1736,df1737,df1738,df1739,df1740,df1741,df1742,df1743,df1744,df1745,df1746,df1747,df1748,df1749,df1750,df1751,df1752,df1753,df1754,df1755,df1756,df1757,df1758,df1759,df1760,df1761,df1762,df1763,df1764,df1765,df1766,df1767,df1768,df1769,df1770,df1771,df1772,df1773,df1774,df1775,df1776,df1777,df1778,df1779,df1780,df1781,df1782,df1783,df1784,df1785,df1786,df1787,df1788,df1789,df1790,df1791,df1792,df1793,df1794,df1795,df1796,df1797,df1798,df1799,df1800,df1801,df1802,df1803,df1804,df1805,df1806,df1807,df1808,df1809,df1810,df1811,df1812,df1813,df1814,df1815,df1816,df1817,df1818,df1819,df1820,df1821,df1822,df1823,df1824,df1825,df1826,df1827,df1828,df1829,df1830,df1831,df1832,df1833,df1834,df1835,df1836,df1837,df1838,df1839,df1840,df1841,df1842,df1843,df1844,df1845,df1846,df1847,df1848,df1849,df1850,df1851,df1852,df1853,df1854,df1855,df1856,df1857,df1858,df1859,df1860,df1861,df1862,df1863,df1864,df1865,df1866,df1867,df1868,df1869,df1870,df1871,df1872,df1873,df1874,df1875,df1876,df1877,df1878,df1879,df1880,df1881,df1882,df1883,df1884,df1885,df1886,df1887,df1888,df1889,df1890,df1891,df1892,df1893,df1894,df1895,df1896,df1897,df1898,df1899,df1900,df1901,df1902,df1903,df1904,df1905,df1906,df1907,df1908,df1909,df1910,df1911,df1912,df1913,df1914,df1915,df1916,df1917,df1918,df1919,df1920,df1921,df1922,df1923,df1924,df1925,df1926,df1927,df1928,df1929,df1930,df1931,df1932,df1933,df1934,df1935,df1936,df1937,df1938,df1939,df1940,df1941,df1942,df1943,df1944,df1945,df1946,df1947,df1948,df1949,df1950,df1951,df1952,df1953,df1954,df1955,df1956,df1957,df1958,df1959,df1960,df1961,df1962,df1963,df1964,df1965,df1966,df1967,df1968,df1969,df1970,df1971,df1972,df1973,df1974,df1975,df1976,df1977,df1978,df1979,df1980,df1981,df1982,df1983,df1984,df1985,df1986,df1987,df1988,df1989,df1990,df1991,df1992,df1993,df1994,df1995,df1996,df1997,df1998,df1999,df2000,df2001,df2002,df2003,df2004,df2005,df2006,df2007,df2008,df2009,df2010,df2011,df2012,df2013,df2014,df2015,df2016,df2017,df2018,df2019,df2020,df2021,df2022,df2023,df2024,df2025,df2026,df2027,df2028,df2029,df2030,df2031,df2032,df2033,df2034,df2035,df2036,df2037,df2038,df2039,df2040,df2041,df2042,df2043,df2044,df2045,df2046,df2047,df2048,df2049,df2050,df2051,df2052,df2053,df2054,df2055,df2056,df2057,df2058,df2059,df2060,df2061,df2062,df2063,df2064,df2065,df2066,df2067,df2068,df2069,df2070,df2071,df2072,df2073,df2074,df2075,df2076,df2077,df2078,df2079,df2080,df2081,df2082,df2083,df2084,df2085,df2086,df2087,df2088,df2089,df2090,df2091,df2092,df2093,df2094,df2095,df2096,df2097,df2098,df2099,df2100,df2101,df2102,df2103,df2104,df2105,df2106,df2107,df2108,df2109,df2110,df2111,df2112,df2113,df2114,df2115,df2116,df2117,df2118,df2119,df2120,df2121,df2122,df2123,df2124,df2125,df2126,df2127,df2128,  df2129,	df2130,	df2131,	df2132,	df2133,	df2134,	df2135,	df2136,	df2137,	df2138,	df2139,	df2140,	df2141,	df2142,	df2143,	df2144,	df2145,	df2146,	df2147,	df2148,	df2149,	df2150,	df2151,	df2152,	df2153,	df2154,	df2155,	df2156,	df2157,	df2158,	df2159,	df2160,	df2161,	df2162,	df2163,	df2164,	df2165,	df2166,	df2167,	df2168,	df2169,	df2170,	df2171,	df2172,	df2173,	df2174,	df2175,	df2176,	df2177,	df2178,	df2179,	df2180,	df2181,	df2182,	df2183,	df2184,	df2185,	df2186,	df2187,	df2188,	df2189,	df2190,	df2191,	df2192,	df2193,	df2194,	df2195,	df2196,	df2197,	df2198,	df2199,	df2200,	df2201,	df2202,	df2203,	df2204,	df2205,	df2206,	df2207,	df2208,	df2209,	df2210,	df2211,	df2212,	df2213,	df2214,	df2215,	df2216,	df2217,	df2218,	df2219,	df2220,	df2221,	df2222,	df2223,	df2224,	df2225,	df2226,	df2227,	df2228,	df2229,	df2230,	df2231,	df2232,	df2233,	df2234,	df2235,	df2236,	df2237,	df2238,	df2239,	df2240,	df2241,	df2242,	df2243,	df2244,	df2245,	df2246,	df2247,	df2248,	df2249,	df2250,	df2251,	df2252,	df2253,	df2254,	df2255,	df2256,	df2257,	df2258,	df2259,	df2260,	df2261,	df2262,	df2263,	df2264,	df2265,	df2266,	df2267,	df2268,	df2269,	df2270,	df2271,	df2272,	df2273,	df2274,	df2275,	df2276,	df2277,	df2278,	df2279,	df2280,	df2281,	df2282,	df2283)

#join5<-rbind(df2284,	df2285,	df2286,	df2287,	df2288,	df2289,	df2290,	df2291,	df2292,	df2293,	df2294,	df2295,	df2296,	df2297,	df2298,	df2299,	df2300,	df2301,	df2302,	df2303,	df2304,	df2305,	df2306,	df2307,	df2308,	df2309,	df2310,	df2311,	df2312,	df2313,	df2314,	df2315,	df2316,	df2317,	df2318,	df2319,	df2320,	df2321,	df2322,	df2323,	df2324,	df2325,	df2326,	df2327,	df2328,	df2329,	df2330,	df2331,	df2332,	df2333,	df2334,	df2335,	df2336,	df2337,	df2338,	df2339,	df2340,	df2341,	df2342,	df2343,	df2344,	df2345,	df2346,	df2347,	df2348,	df2349,	df2350,	df2351,	df2352,	df2353,	df2354,	df2355,	df2356,	df2357,	df2358,	df2359,	df2360,	df2361,	df2362,	df2363,	df2364,	df2365,	df2366,	df2367,	df2368,	df2369,	df2370,	df2371,	df2372,	df2373,	df2374,	df2375,	df2376,	df2377,	df2378,	df2379,	df2380,	df2381,	df2382,	df2383,	df2384,	df2385,	df2386,	df2387,	df2388,	df2389,	df2390,	df2391,	df2392,	df2393,	df2394,	df2395,	df2396,	df2397,	df2398,	df2399,	df2400,	df2401,	df2402,	df2403,	df2404,	df2405,	df2406,	df2407,	df2408,	df2409,	df2410,	df2411,	df2412,	df2413,	df2414,	df2415,	df2416,	df2417,	df2418,	df2419,	df2420,	df2421,	df2422,	df2423,	df2424,	df2425,	df2426,	df2427,	df2428,	df2429,	df2430,	df2431,	df2432,	df2433,	df2434,	df2435,	df2436,	df2437,	df2438,	df2439,	df2440,	df2441,	df2442,	df2443,	df2444,	df2445,	df2446,	df2447,	df2448,	df2449,	df2450,	df2451,	df2452,	df2453,	df2454,	df2455,	df2456,	df2457,	df2458,	df2459,	df2460,	df2461,	df2462,	df2463,	df2464,	df2465,	df2466,	df2467,	df2468,	df2469,	df2470,	df2471,	df2472,	df2473,	df2474,	df2475,	df2476,	df2477,	df2478,	df2479,	df2480,	df2481,	df2482,	df2483,	df2484,	df2485,	df2486,	df2487,	df2488,	df2489,	df2490,	df2491,	df2492,	df2493,	df2494,	df2495,	df2496,	df2497,	df2498,	df2499,	df2500,	df2501,	df2502,	df2503,	df2504,	df2505,	df2506,	df2507,	df2508,	df2509,	df2510,	df2511,	df2512,	df2513,	df2514,	df2515,	df2516,	df2517,	df2518,	df2519,	df2520,	df2521,	df2522,	df2523,	df2524,	df2525,	df2526,	df2527,	df2528,	df2529,	df2530,	df2531,	df2532,	df2533,	df2534,	df2535,	df2536,	df2537,	df2538,	df2539,	df2540,	df2541,	df2542,	df2543,	df2544,	df2545,	df2546,	df2547,	df2548,	df2549,	df2550,	df2551,	df2552,	df2553,	df2554,	df2555,	df2556,	df2557,	df2558,	df2559,	df2560,	df2561,	df2562,	df2563,	df2564,	df2565,	df2566,	df2567,	df2568,	df2569,	df2570,	df2571,	df2572,	df2573,	df2574,	df2575,	df2576,	df2577,	df2578,	df2579,	df2580,	df2581,	df2582,	df2583,	df2584,	df2585,	df2586,	df2587,	df2588,	df2589,	df2590,	df2591,	df2592,	df2593,	df2594,	df2595,	df2596,	df2597,	df2598,	df2599,	df2600,	df2601,	df2602,	df2603,	df2604,	df2605,	df2606,	df2607,	df2608,	df2609,	df2610,	df2611,	df2612,	df2613,	df2614,	df2615,	df2616,	df2617,	df2618,	df2619,	df2620,	df2621,	df2622,	df2623,	df2624,	df2625,	df2626,	df2627,	df2628,	df2629,	df2630,	df2631,	df2632,	df2633,	df2634,	df2635,	df2636,	df2637,	df2638,	df2639,	df2640,	df2641,	df2642,	df2643,	df2644,	df2645,	df2646,	df2647,	df2648,	df2649,	df2650,	df2651,	df2652,	df2653,	df2654,	df2655,	df2656,	df2657,	df2658,	df2659,	df2660,	df2661,	df2662,	df2663,	df2664,	df2665,	df2666,	df2667,	df2668,	df2669,	df2670,	df2671,	df2672,	df2673,	df2674,	df2675,	df2676,	df2677,	df2678,	df2679,	df2680,	df2681,	df2682,	df2683,	df2684,	df2685,	df2686,	df2687,	df2688,	df2689,	df2690,	df2691,	df2692,	df2693,	df2694,	df2695,	df2696,	df2697,	df2698,	df2699,	df2700,	df2701,	df2702,	df2703,	df2704,	df2705,	df2706,	df2707,	df2708,	df2709,	df2710,	df2711,	df2712,	df2713,	df2714,	df2715,	df2716,	df2717,	df2718,	df2719,	df2720,	df2721,	df2722,	df2723,	df2724,	df2725,	df2726,	df2727,	df2728,	df2729,	df2730,	df2731,	df2732,	df2733,	df2734,	df2735,	df2736,	df2737,	df2738,	df2739,	df2740,	df2741,	df2742,	df2743,	df2744,	df2745,	df2746,	df2747,	df2748,	df2749,	df2750,	df2751,	df2752,	df2753,	df2754,	df2755,	df2756,	df2757,	df2758,	df2759,	df2760,	df2761,	df2762,	df2763,	df2764,	df2765,	df2766,	df2767,	df2768,	df2769,	df2770,	df2771,	df2772,	df2773,	df2774,	df2775,	df2776,	df2777,	df2778,	df2779,	df2780,	df2781,	df2782,	df2783,	df2784,	df2785,	df2786,	df2787,	df2788,	df2789,	df2790,	df2791,	df2792,	df2793,	df2794,	df2795,	df2796,	df2797,	df2798,	df2799,	df2800,	df2801,	df2802,	df2803,	df2804,	df2805,	df2806,	df2807,	df2808,	df2809,	df2810,	df2811,	df2812,	df2813,	df2814,	df2815,	df2816,	df2817,	df2818,	df2819,	df2820,	df2821,	df2822,	df2823,	df2824,	df2825,	df2826,	df2827,	df2828,	df2829,	df2830,	df2831,	df2832,	df2833,	df2834,	df2835,	df2836,	df2837,	df2838,	df2839,	df2840,	df2841,	df2842,	df2843,	df2844,	df2845,	df2846,	df2847,	df2848,	df2849,	df2850,	df2851,	df2852,	df2853,	df2854,	df2855,	df2856,	df2857,	df2858,	df2859,	df2860,	df2861,	df2862,	df2863,	df2864,	df2865,	df2866)

#join6<-rbind(df2867,	df2868,	df2869,	df2870,	df2871,	df2872,	df2873,	df2874,	df2875,	df2876,	df2877,	df2878,	df2879,	df2880,	df2881,	df2882,	df2883,	df2884,	df2885,	df2886,	df2887,	df2888,	df2889,	df2890,	df2891,	df2892,	df2893,	df2894,	df2895,	df2896,	df2897,	df2898,	df2899,	df2900,	df2901,	df2902,	df2903,	df2904,	df2905,	df2906,	df2907,	df2908,	df2909,	df2910,	df2911,	df2912,	df2913,	df2914,	df2915,	df2916,	df2917,	df2918,	df2919,	df2920,	df2921,	df2922,	df2923,	df2924,	df2925,	df2926,	df2927,	df2928,	df2929,	df2930,	df2931,	df2932,	df2933,	df2934,	df2935,	df2936,	df2937,	df2938,	df2939,	df2940,	df2941,	df2942,	df2943,	df2944,	df2945,	df2946,	df2947,	df2948,	df2949,	df2950,	df2951,	df2952,	df2953,	df2954,	df2955,	df2956,	df2957,	df2958,	df2959,	df2960,	df2961,	df2962,	df2963,	df2964,	df2965,	df2966,	df2967,	df2968,	df2969,	df2970,	df2971,	df2972,	df2973,	df2974,	df2975,	df2976,	df2977,	df2978,	df2979,	df2980,	df2981,	df2982,	df2983,	df2984,	df2985,	df2986,	df2987,	df2988,	df2989,	df2990,	df2991,	df2992,	df2993,	df2994,	df2995,	df2996,	df2997,	df2998,	df2999,	df3000,	df3001,	df3002,	df3003,	df3004,	df3005,	df3006,	df3007,	df3008,	df3009,	df3010,	df3011,	df3012,	df3013,	df3014,	df3015,	df3016,	df3017,	df3018,	df3019,	df3020,	df3021,	df3022,	df3023,	df3024,	df3025,	df3026,	df3027,	df3028,	df3029,	df3030,	df3031,	df3032,	df3033,	df3034,	df3035,	df3036,	df3037,	df3038,	df3039,	df3040,	df3041,	df3042,	df3043,	df3044,	df3045,	df3046,	df3047,	df3048,	df3049,	df3050,	df3051,	df3052,	df3053,	df3054,	df3055,	df3056,	df3057,	df3058,	df3059,	df3060,	df3061,	df3062,	df3063,	df3064,	df3065,	df3066,	df3067,	df3068,	df3069,	df3070,	df3071,	df3072,	df3073,	df3074,	df3075,	df3076,	df3077,	df3078,	df3079,	df3080,	df3081,	df3082,	df3083,	df3084,	df3085,	df3086,	df3087,	df3088,	df3089,	df3090,	df3091,	df3092,	df3093,	df3094,	df3095,	df3096,	df3097,	df3098,	df3099,	df3100,	df3101,	df3102,	df3103,	df3104,	df3105,	df3106,	df3107,	df3108,	df3109,	df3110,	df3111,	df3112,	df3113,	df3114,	df3115,	df3116,	df3117,	df3118,	df3119,	df3120,	df3121,	df3122,	df3123,	df3124,	df3125,	df3126,	df3127,	df3128,	df3129,	df3130,	df3131,	df3132,	df3133,	df3134,	df3135,	df3136,	df3137,	df3138,	df3139,	df3140,	df3141,	df3142,	df3143,	df3144,	df3145,	df3146,	df3147,	df3148,	df3149,	df3150)

#join7<-rbind(df3151,	df3152,	df3153,	df3154,	df3155,	df3156,	df3157,	df3158,	df3159,	df3160,	df3161,	df3162,	df3163,	df3164,	df3165,	df3166,	df3167,	df3168,	df3169,	df3170,	df3171,	df3172,	df3173,	df3174,	df3175,	df3176,	df3177,	df3178,	df3179,	df3180,	df3181,	df3182,	df3183,	df3184,	df3185,	df3186,	df3187,	df3188,	df3189,	df3190,	df3191,	df3192,	df3193,	df3194,	df3195,	df3196,	df3197,	df3198,	df3199,	df3200,	df3201,	df3202,	df3203,	df3204,	df3205,	df3206,	df3207,	df3208,	df3209,	df3210,	df3211,	df3212,	df3213,	df3214,	df3215,	df3216,	df3217,	df3218,	df3219,	df3220,	df3221,	df3222,	df3223,	df3224,	df3225,	df3226,	df3227,	df3228,	df3229,	df3230,	df3231,	df3232,	df3233,	df3234,	df3235,	df3236,	df3237,	df3238,	df3239,	df3240,	df3241,	df3242,	df3243,	df3244,	df3245,	df3246,	df3247,	df3248,	df3249,	df3250,	df3251,	df3252,	df3253,	df3254,	df3255,	df3256,	df3257,	df3258,	df3259,	df3260,	df3261,	df3262,	df3263,	df3264,	df3265,	df3266,	df3267,	df3268,	df3269,	df3270,	df3271,	df3272,	df3273,	df3274,	df3275,	df3276,	df3277,	df3278,	df3279,	df3280,	df3281,	df3282,	df3283,	df3284,	df3285,	df3286,	df3287,	df3288,	df3289,	df3290,	df3291,	df3292,	df3293,	df3294,	df3295,	df3296,	df3297,	df3298,	df3299,	df3300,	df3301,	df3302,	df3303,	df3304,	df3305,	df3306,	df3307,	df3308,	df3309,	df3310,	df3311,	df3312,	df3313,	df3314,	df3315,	df3316,	df3317,	df3318,	df3319,	df3320,	df3321,	df3322,	df3323,	df3324,	df3325,	df3326,	df3327,	df3328,	df3329,	df3330,	df3331,	df3332,	df3333,	df3334,	df3335,	df3336,	df3337,	df3338,	df3339,	df3340,	df3341,	df3342,	df3343,	df3344,	df3345,	df3346,	df3347,	df3348,	df3349,	df3350,	df3351,	df3352,	df3353,	df3354,	df3355,	df3356,	df3357,	df3358,	df3359,	df3360,	df3361,	df3362,	df3363,	df3364,	df3365,	df3366,	df3367,	df3368,	df3369,	df3370,	df3371,	df3372,	df3373,	df3374,	df3375,	df3376,	df3377,	df3378,	df3379,	df3380,	df3381,	df3382,	df3383,	df3384,	df3385,	df3386,	df3387,	df3388,	df3389,	df3390,	df3391,	df3392,	df3393,	df3394,	df3395,	df3396,	df3397,	df3398,	df3399,	df3400,	df3401,	df3402,	df3403,	df3404,	df3405,	df3406,	df3407,	df3408,	df3409,	df3410,	df3411,	df3412,	df3413,	df3414,	df3415,	df3416,	df3417,	df3418,	df3419,	df3420,	df3421,	df3422,	df3423,	df3424,	df3425,	df3426,	df3427,	df3428,	df3429,	df3430,	df3431,	df3432,	df3433,	df3434,	df3435,	df3436,	df3437,	df3438,	df3439,	df3440,	df3441,	df3442,	df3443,	df3444,	df3445,	df3446,	df3447,	df3448,	df3449,	df3450,	df3451,	df3452)

coef_plausible_model<-rbind(join) #,join2,join3,join4,join5,join6,join7)   
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
## Mean using excel by removing numbers from the first column

#######################################################################################################################################################################
## COVER
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Cover==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 2.1533
data2<-subset(data2, data2$abRR<2.1533)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m6<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m9<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m10<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m15<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m20<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m26<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m27<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m4))
  r2[[i]]<-r.squaredLR(m4, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(attr(r2[[i]],"adj.r.squared")) 
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==4) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model
Coef_estimate<-list()
Coef_se<-list()
for(i in 1:100){
  coef<-coef
  df<-data.frame(coef[[i]][[1]][12]) 
  Coef_estimate[[i]]<-df[,1]
  Coef_se[[i]]<-df[,2]
}
df_Coef_estimate<-data.frame(matrix(unlist(Coef_estimate), nrow=100, byrow=T))
df_Coef_se<-data.frame(matrix(unlist(Coef_se), nrow=100, byrow=T))
Coef_estimate_se<-cbind(df_Coef_estimate,df_Coef_se)
coef_table<-cbind(df_top_ranked[,7],Coef_estimate_se)
coef_plausible_model<-subset(coef_table, coef_table[,1]==4) 
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
coef_plausible_model_mean<-as.data.frame(apply(coef_plausible_model, 2, mean))
write.table(coef_plausible_model_mean, "m.Coef_plausible_model_mean.txt", quote=F, sep="\t")

#######################################################################################################################################################################
## DENSITY
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Density==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.6346
data2<-subset(data2, data2$abRR<1.6346)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
#se.coef<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m6<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m9<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m10<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m15<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m20<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m26<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m27<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m2))
  r2[[i]]<-r.squaredLR(m2, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink()

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(attr(r2[[i]],"adj.r.squared")) 
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==2) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model
Coef_estimate<-list()
Coef_se<-list()
for(i in 1:100){
  coef<-coef
  df<-data.frame(coef[[i]][[1]][12]) 
  Coef_estimate[[i]]<-df[,1]
  Coef_se[[i]]<-df[,2]
}
df_Coef_estimate<-data.frame(matrix(unlist(Coef_estimate), nrow=100, byrow=T))
df_Coef_se<-data.frame(matrix(unlist(Coef_se), nrow=10, byrow=T))
Coef_estimate_se<-cbind(df_Coef_estimate,df_Coef_se)
coef_table<-cbind(df_top_ranked[,7],Coef_estimate_se)
coef_plausible_model<-subset(coef_table, coef_table[,1]==2) 
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
coef_plausible_model_mean<-as.data.frame(apply(coef_plausible_model, 2, mean))
write.table(coef_plausible_model_mean, "m.Coef_plausible_model_mean.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model - FACTORS
top_ranked_model.x<-as.data.frame(which(df_top_ranked[,7]==2)) 
write.table(top_ranked_model.x,"top_ranked_model.2.txt", sep="\t")
## Excel file - Example below

df1<-data.frame(coef[[1]][[1]][12])
df2<-data.frame(coef[[4]][[1]][12])
...

############## join coefs  
join<-rbind(df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40,df41,df42,df43,df44,df45,df46,df47,df48,df49,df50,df51,df52,df53,df54,df55,df56,df57,df58,df59,df60,df61,df62,df63,df64,df65,df66,df67,df68,df69,df70,df71,df72,df73,df74,df75,df76,df77,df78,df79,df80,df81,df82,df83,df84,df85,df86,df87,df88,df89,df90,df91,df92,df93,df94,df95,df96,df97,df98,df99,df100,df101,df102,df103,df104,df105,df106,df107,df108,df109,df110,df111,df112,df113,df114,df115,df116,df117,df118,df119,df120,df121,df122,df123,df124,df125,df126,df127,df128,df129,df130,df131,df132,df133,df134,df135,df136,df137,df138,df139,df140,df141,df142,df143,df144,df145,df146,df147,df148,df149,df150,df151,df152,df153,df154,df155,df156,df157,df158,df159,df160,df161,df162,df163,df164,df165,df166,df167,df168,df169,df170,df171,df172,df173,df174,df175,df176,df177,df178,df179,df180,df181,df182,df183,df184,df185,df186,df187,df188,df189,df190,df191,df192,df193,df194,df195,df196,df197,df198,df199,df200,df201,df202,df203,df204,df205,df206,df207,df208,df209,df210,df211,df212,df213,df214,df215,df216,df217,df218,df219,df220,df221,df222,df223,df224,df225,df226,df227,df228,df229,df230,df231,df232,df233,df234,df235,df236,df237,df238,df239,df240,df241,df242,df243,df244,df245,df246,df247,df248,df249,df250,df251,df252,df253,df254,df255,df256,df257,df258,df259,df260,df261,df262,df263,df264,df265,df266,df267,df268,df269,df270,df271,df272,df273,df274,df275,df276,df277,df278,df279,df280,df281,df282,df283,df284,df285,df286,df287,df288,df289,df290,df291,df292,df293,df294,df295,df296,df297,df298,df299,df300,df301,df302,df303,df304,df305,df306,df307,df308,df309,df310,df311,df312,df313,df314,df315,df316,df317,df318,df319,df320,df321,df322,df323,df324,df325,df326,df327,df328,df329,df330,df331,df332,df333,df334,df335,df336,df337,df338,df339,df340,df341,df342,df343,df344,df345,df346,df347,df348,df349,df350,df351,df352,df353,df354,df355,df356,df357,df358,df359,df360,df361,df362,df363,df364,df365,df366,df367,df368,df369,df370,df371,df372,df373,df374,df375,df376,df377,df378,df379,df380,df381,df382,df383,df384,df385,df386,df387,df388,df389,df390,df391,df392,df393,df394,df395,df396,df397,df398,df399,df400,df401,df402,df403,df404,df405,df406,df407,df408,df409,df410,df411,df412,df413,df414,df415,df416,df417,df418,df419,df420,df421,df422,df423,df424,df425,df426,df427,df428,df429,df430,df431,df432,df433,df434,df435,df436,df437,df438,df439,df440,df441,df442,df443,df444,df445,df446,df447,df448,df449,df450,df451,df452,df453,df454,df455,df456,df457,df458,df459,df460,df461,df462,df463,df464,df465,df466,df467,df468,df469,df470,df471,df472,df473,df474,df475,df476,df477,df478,df479,df480,df481,df482,df483,df484,df485,df486,df487,df488,df489,df490,df491,df492,df493,df494,df495,df496,df497,df498,df499,df500,df501,df502,df503,df504,df505,df506,df507,df508,df509,df510,df511,df512,df513,df514,df515,df516,df517,df518,df519,df520,df521,df522,df523,df524,df525,df526,df527,df528,df529,df530,df531,df532,df533,df534,df535,df536,df537,df538,df539,df540,df541,df542,df543,df544,df545,df546,df547,df548,df549,df550,df551,df552,df553,df554,df555,df556,df557,df558,df559,df560,df561,df562,df563,df564,df565,df566,df567,df568,df569,df570,df571,df572,df573,df574,df575,df576,df577,df578,df579,df580,df581,df582,df583,df584,df585,df586,df587,df588,df589,df590,df591,df592,df593,df594,df595,df596,df597,df598,df599,df600)

#join2<-rbind(df601,df602,df603,df604,df605,df606,df607,df608,df609,df610,df611,df612,df613,df614,df615,df616,df617,df618,df619,df620,df621,df622,df623,df624,df625,df626,df627,df628,df629,df630,df631,df632,df633,df634,df635,df636,df637,df638,df639,df640,df641,df642,df643,df644,df645,df646,df647,df648,df649,df650,df651,df652,df653,df654,df655,df656,df657,df658,df659,df660,df661,df662,df663,df664,df665,df666,df667,df668,df669,df670,df671,df672,df673,df674,df675,df676,df677,df678,df679,df680,df681,df682,df683,df684,df685,df686,df687,df688,df689,df690,df691,df692,df693,df694,df695,df696,df697,df698,df699,df700,df701,df702,df703,df704,df705,df706,df707,df708,df709,df710,df711,df712,df713,df714,df715,df716,df717,df718,df719,df720,df721,df722,df723,df724,df725,df726,df727,df728,df729,df730,df731,df732,df733,df734,df735,df736,df737,df738,df739,df740,df741,df742,df743,df744,df745,df746,df747,df748,df749,df750,df751,df752,df753,df754,df755,df756,df757,df758,df759,df760,df761,df762,df763,df764,df765,df766,df767,df768,df769,df770,df771,df772,df773,df774,df775,df776,df777,df778,df779,df780,df781,df782,df783,df784,df785,df786,df787,df788,df789,df790,df791,df792,df793,df794,df795,df796,df797,df798,df799,df800,df801,df802,df803,df804,df805,df806,df807,df808,df809,df810,df811,df812,df813,df814,df815,df816,df817,df818,df819,df820,df821,df822,df823,df824,df825,df826,df827,df828,df829,df830,df831,df832,df833,df834,df835,df836,df837,df838,df839,df840,df841,df842,df843,df844,df845,df846,df847,df848,df849,df850,df851,df852,df853,df854,df855,df856,df857,df858,df859,df860,df861,df862,df863,df864,df865,df866,df867,df868,df869,df870,df871,df872,df873,df874,df875,df876,df877,df878,df879,df880,df881,df882,df883,df884,df885,df886,df887,df888,df889,df890,df891,df892,df893,df894,df895,df896,df897,df898,df899,df900,df901,df902,df903,df904,df905,df906,df907,df908,df909,df910,df911,df912,df913,df914,df915,df916,df917,df918,df919,df920,df921,df922,df923,df924,df925,df926,df927,df928,df929,df930,df931,df932,df933,df934,df935,df936,df937,df938,df939,df940,df941,df942,df943,df944,df945,df946,df947,df948,df949,df950,df951,df952,df953,df954,df955,df956,df957,df958,df959,df960,df961,df962,df963,df964,df965,df966,df967,df968,df969,df970,df971,df972,df973,df974,df975,df976,df977,df978,df979,df980,df981,df982,df983,df984,df985,df986,df987,df988,df989,df990,df991,df992,df993,df994,df995,df996,df997,df998,df999,df1000,df1001,df1002,df1003,df1004,df1005,df1006,df1007,df1008,df1009,df1010,df1011,df1012,df1013,df1014,df1015,df1016,df1017,df1018,df1019,df1020,df1021,df1022,df1023,df1024,df1025,df1026,df1027,df1028,df1029,df1030,df1031,df1032,df1033,df1034,df1035,df1036,df1037,df1038,df1039,df1040,df1041,df1042,df1043,df1044,df1045,df1046,df1047,df1048,df1049,df1050,df1051,df1052,df1053,df1054,df1055,df1056,df1057,df1058,df1059,df1060,df1061,df1062,df1063,df1064,df1065,df1066,df1067,df1068,df1069,df1070,df1071,df1072,df1073,df1074,df1075,df1076,df1077,df1078,df1079,df1080,df1081,df1082,df1083,df1084,df1085,df1086,df1087,df1088,df1089,df1090,df1091,df1092,df1093,df1094,df1095,df1096,df1097,df1098,df1099,df1100,df1101,df1102,df1103,df1104,df1105,df1106,df1107,df1108,df1109,df1110,df1111,df1112,df1113,df1114,df1115,df1116,df1117,df1118,df1119,df1120,df1121,df1122,df1123,df1124,df1125,df1126,df1127,df1128,df1129,df1130,df1131,df1132,df1133,df1134,df1135,df1136,df1137,df1138,df1139,df1140,df1141,df1142,df1143,df1144,df1145,df1146,df1147,df1148,df1149,df1150,df1151,df1152,df1153,df1154,df1155,df1156,df1157,df1158,df1159,df1160,df1161,df1162,df1163,df1164,df1165,df1166,df1167,df1168,df1169,df1170,df1171,df1172,df1173,df1174,df1175,df1176,df1177,df1178,df1179,df1180,df1181,df1182,df1183,df1184,df1185,df1186,df1187,df1188,df1189,df1190,df1191,df1192,df1193,df1194,df1195,df1196,df1197,df1198,df1199,df1200)

#join3<-rbind(df1201,df1202,df1203,df1204,df1205,df1206,df1207,df1208,df1209,df1210,df1211,df1212,df1213,df1214,df1215,df1216,df1217,df1218,df1219,df1220,df1221,df1222,df1223,df1224,df1225,df1226,df1227,df1228,df1229,df1230,df1231,df1232,df1233,df1234,df1235,df1236,df1237,df1238,df1239,df1240,df1241,df1242,df1243,df1244,df1245,df1246,df1247,df1248,df1249,df1250,df1251,df1252,df1253,df1254,df1255,df1256,df1257,df1258,df1259,df1260,df1261,df1262,df1263,df1264,df1265,df1266,df1267,df1268,df1269,df1270,df1271,df1272,df1273,df1274,df1275,df1276,df1277,df1278,df1279,df1280,df1281,df1282,df1283,df1284,df1285,df1286,df1287,df1288,df1289,df1290,df1291,df1292,df1293,df1294,df1295,df1296,df1297,df1298,df1299,df1300,df1301,df1302,df1303,df1304,df1305,df1306,df1307,df1308,df1309,df1310,df1311,df1312,df1313,df1314,df1315,df1316,df1317,df1318,df1319,df1320,df1321,df1322,df1323,df1324,df1325,df1326,df1327,df1328,df1329,df1330,df1331,df1332,df1333,df1334,df1335,df1336,df1337,df1338,df1339,df1340,df1341,df1342,df1343,df1344,df1345,df1346,df1347,df1348,df1349,df1350,df1351,df1352,df1353,df1354,df1355,df1356,df1357,df1358,df1359,df1360,df1361,df1362,df1363,df1364,df1365,df1366,df1367,df1368,df1369,df1370,df1371,df1372,df1373,df1374,df1375,df1376,df1377,df1378,df1379,df1380,df1381,df1382,df1383,df1384,df1385,df1386,df1387,df1388,df1389,df1390,df1391,df1392,df1393,df1394,df1395,df1396,df1397,df1398,df1399,df1400,df1401,df1402,df1403,df1404,df1405,df1406,df1407,df1408,df1409,df1410,df1411,df1412,df1413,df1414,df1415,df1416,df1417,df1418,df1419,df1420,df1421,df1422,df1423,df1424,df1425,df1426,df1427,df1428,df1429,df1430,df1431,df1432,df1433,df1434,df1435,df1436,df1437,df1438,df1439,df1440,df1441,df1442,df1443,df1444,df1445,df1446,df1447,df1448,df1449,df1450,df1451,df1452,df1453,df1454,df1455,df1456,df1457,df1458,df1459,df1460,df1461,df1462,df1463,df1464,df1465,df1466,df1467,df1468,df1469,df1470,df1471,df1472,df1473,df1474,df1475,df1476,df1477,df1478,df1479,df1480,df1481,df1482,df1483,df1484,df1485,df1486,df1487,df1488,df1489,df1490,df1491,df1492,df1493,df1494,df1495,df1496,df1497,df1498,df1499,df1500,df1501,df1502,df1503,df1504,df1505,df1506,df1507,df1508,df1509,df1510,df1511,df1512,df1513,df1514,df1515,df1516,df1517,df1518,df1519,df1520,df1521,df1522,df1523,df1524,df1525,df1526,df1527,df1528,df1529,df1530,df1531,df1532,df1533,df1534,df1535,df1536,df1537,df1538,df1539,df1540,df1541,df1542,df1543,df1544,df1545,df1546,df1547,df1548,df1549,df1550,df1551,df1552,df1553,df1554,df1555,df1556,df1557,df1558,df1559,df1560,df1561,df1562,df1563,df1564,df1565,df1566,df1567,df1568,df1569,df1570,df1571,df1572,df1573,df1574,df1575,df1576,df1577,df1578,df1579,df1580,df1581,df1582,df1583,df1584,df1585,df1586,df1587,df1588,df1589,df1590,df1591,df1592,df1593,df1594,df1595,df1596,df1597,df1598,df1599,df1600,df1601,df1602,df1603,df1604,df1605,df1606,df1607,df1608,df1609,df1610,df1611,df1612,df1613,df1614,df1615,df1616,df1617,df1618,df1619,df1620,df1621,df1622,df1623,df1624,df1625,df1626,df1627,df1628,df1629,df1630,df1631,df1632,df1633,df1634,df1635,df1636,df1637,df1638,df1639,df1640,df1641,df1642,df1643,df1644,df1645,df1646,df1647,df1648,df1649,df1650,df1651,df1652,df1653,df1654,df1655,df1656,df1657,df1658,df1659,df1660,df1661,df1662,df1663,df1664,df1665,df1666,df1667,df1668,df1669,df1670,df1671,df1672,df1673,df1674,df1675,df1676,df1677,df1678,df1679,df1680,df1681,df1682,df1683,df1684,df1685,df1686,df1687,df1688,df1689,df1690,df1691,df1692,df1693,df1694,df1695,df1696,df1697,df1698,df1699,df1700)

#join4<-rbind(df1701,df1702,df1703,df1704,df1705,df1706,df1707,df1708,df1709,df1710,df1711,df1712,df1713,df1714,df1715,df1716,df1717,df1718,df1719,df1720,df1721,df1722,df1723,df1724,df1725,df1726,df1727,df1728,df1729,df1730,df1731,df1732,df1733,df1734,df1735,df1736,df1737,df1738,df1739,df1740,df1741,df1742,df1743,df1744,df1745,df1746,df1747,df1748,df1749,df1750,df1751,df1752,df1753,df1754,df1755,df1756,df1757,df1758,df1759,df1760,df1761,df1762,df1763,df1764,df1765,df1766,df1767,df1768,df1769,df1770,df1771,df1772,df1773,df1774,df1775,df1776,df1777,df1778,df1779,df1780,df1781,df1782,df1783,df1784,df1785,df1786,df1787,df1788,df1789,df1790,df1791,df1792,df1793,df1794,df1795,df1796,df1797,df1798,df1799,df1800,df1801,df1802,df1803,df1804,df1805,df1806,df1807,df1808,df1809,df1810,df1811,df1812,df1813,df1814,df1815,df1816,df1817,df1818,df1819,df1820,df1821,df1822,df1823,df1824,df1825,df1826,df1827,df1828,df1829,df1830,df1831,df1832,df1833,df1834,df1835,df1836,df1837,df1838,df1839,df1840,df1841,df1842,df1843,df1844,df1845,df1846,df1847,df1848,df1849,df1850,df1851,df1852,df1853,df1854,df1855,df1856,df1857,df1858,df1859,df1860,df1861,df1862,df1863,df1864,df1865,df1866,df1867,df1868,df1869,df1870,df1871,df1872,df1873,df1874,df1875,df1876,df1877,df1878,df1879,df1880,df1881,df1882,df1883,df1884,df1885,df1886,df1887,df1888,df1889,df1890,df1891,df1892,df1893,df1894,df1895,df1896,df1897,df1898,df1899,df1900,df1901,df1902,df1903,df1904,df1905,df1906,df1907,df1908,df1909,df1910,df1911,df1912,df1913,df1914,df1915,df1916,df1917,df1918,df1919,df1920,df1921,df1922,df1923,df1924,df1925,df1926,df1927,df1928,df1929,df1930,df1931,df1932,df1933,df1934,df1935,df1936,df1937,df1938,df1939,df1940,df1941,df1942,df1943,df1944,df1945,df1946,df1947,df1948,df1949,df1950,df1951,df1952,df1953,df1954,df1955,df1956,df1957,df1958,df1959,df1960,df1961,df1962,df1963,df1964,df1965,df1966,df1967,df1968,df1969,df1970,df1971,df1972,df1973,df1974,df1975,df1976,df1977,df1978,df1979,df1980,df1981,df1982,df1983,df1984,df1985,df1986,df1987,df1988,df1989,df1990,df1991,df1992,df1993,df1994,df1995,df1996,df1997,df1998,df1999,df2000,df2001,df2002,df2003,df2004,df2005,df2006,df2007,df2008,df2009,df2010,df2011,df2012,df2013,df2014,df2015,df2016,df2017,df2018,df2019,df2020,df2021,df2022,df2023,df2024,df2025,df2026,df2027,df2028,df2029,df2030,df2031,df2032,df2033,df2034,df2035,df2036,df2037,df2038,df2039,df2040,df2041,df2042,df2043,df2044,df2045,df2046,df2047,df2048,df2049,df2050,df2051,df2052,df2053,df2054,df2055,df2056,df2057,df2058,df2059,df2060,df2061,df2062,df2063,df2064,df2065,df2066,df2067,df2068,df2069,df2070,df2071,df2072,df2073,df2074,df2075,df2076,df2077,df2078,df2079,df2080,df2081,df2082,df2083,df2084,df2085,df2086,df2087,df2088,df2089,df2090,df2091,df2092,df2093,df2094,df2095,df2096,df2097,df2098,df2099,df2100,df2101,df2102,df2103,df2104,df2105,df2106,df2107,df2108,df2109,df2110,df2111,df2112,df2113,df2114,df2115,df2116,df2117,df2118,df2119,df2120,df2121,df2122,df2123,df2124,df2125,df2126,df2127,df2128,	df2129,	df2130,	df2131,	df2132,	df2133,	df2134,	df2135,	df2136,	df2137,	df2138,	df2139,	df2140,	df2141,	df2142,	df2143,	df2144,	df2145,	df2146,	df2147,	df2148,	df2149,	df2150,	df2151,	df2152,	df2153,	df2154,	df2155,	df2156,	df2157,	df2158,	df2159,	df2160,	df2161,	df2162,	df2163,	df2164,	df2165,	df2166,	df2167,	df2168,	df2169,	df2170,	df2171,	df2172,	df2173,	df2174,	df2175,	df2176,	df2177,	df2178,	df2179,	df2180,	df2181,	df2182,	df2183,	df2184,	df2185,	df2186,	df2187,	df2188,	df2189,	df2190,	df2191,	df2192,	df2193,	df2194,	df2195,	df2196,	df2197,	df2198,	df2199,	df2200,	df2201,	df2202,	df2203,	df2204,	df2205,	df2206,	df2207,	df2208,	df2209,	df2210,	df2211,	df2212,	df2213,	df2214,	df2215,	df2216,	df2217,	df2218,	df2219,	df2220,	df2221,	df2222,	df2223,	df2224,	df2225,	df2226,	df2227,	df2228,	df2229,	df2230,	df2231,	df2232,	df2233,	df2234,	df2235,	df2236,	df2237,	df2238,	df2239,	df2240,	df2241,	df2242,	df2243,	df2244,	df2245,	df2246,	df2247,	df2248,	df2249,	df2250,	df2251,	df2252,	df2253,	df2254,	df2255,	df2256,	df2257,	df2258,	df2259,	df2260,	df2261,	df2262,	df2263,	df2264,	df2265,	df2266,	df2267,	df2268,	df2269,	df2270,	df2271,	df2272,	df2273,	df2274,	df2275,	df2276,	df2277,	df2278,	df2279,	df2280,	df2281,	df2282,	df2283)

#join5<-rbind(df2284,  df2285,	df2286,	df2287,	df2288,	df2289,	df2290,	df2291,	df2292,	df2293,	df2294,	df2295,	df2296,	df2297,	df2298,	df2299,	df2300,	df2301,	df2302,	df2303,	df2304,	df2305,	df2306,	df2307,	df2308,	df2309,	df2310,	df2311,	df2312,	df2313,	df2314,	df2315,	df2316,	df2317,	df2318,	df2319,	df2320,	df2321,	df2322,	df2323,	df2324,	df2325,	df2326,	df2327,	df2328,	df2329,	df2330,	df2331,	df2332,	df2333,	df2334,	df2335,	df2336,	df2337,	df2338,	df2339,	df2340,	df2341,	df2342,	df2343,	df2344,	df2345,	df2346,	df2347,	df2348,	df2349,	df2350,	df2351,	df2352,	df2353,	df2354,	df2355,	df2356,	df2357,	df2358,	df2359,	df2360,	df2361,	df2362,	df2363,	df2364,	df2365,	df2366,	df2367,	df2368,	df2369,	df2370,	df2371,	df2372,	df2373,	df2374,	df2375,	df2376,	df2377,	df2378,	df2379,	df2380,	df2381,	df2382,	df2383,	df2384,	df2385,	df2386,	df2387,	df2388,	df2389,	df2390,	df2391,	df2392,	df2393,	df2394,	df2395,	df2396,	df2397,	df2398,	df2399,	df2400,	df2401,	df2402,	df2403,	df2404,	df2405,	df2406,	df2407,	df2408,	df2409,	df2410,	df2411,	df2412,	df2413,	df2414,	df2415,	df2416,	df2417,	df2418,	df2419,	df2420,	df2421,	df2422,	df2423,	df2424,	df2425,	df2426,	df2427,	df2428,	df2429,	df2430,	df2431,	df2432,	df2433,	df2434,	df2435,	df2436,	df2437,	df2438,	df2439,	df2440,	df2441,	df2442,	df2443,	df2444,	df2445,	df2446,	df2447,	df2448,	df2449,	df2450,	df2451,	df2452,	df2453,	df2454,	df2455,	df2456,	df2457,	df2458,	df2459,	df2460,	df2461,	df2462,	df2463,	df2464,	df2465,	df2466,	df2467,	df2468,	df2469,	df2470,	df2471,	df2472,	df2473,	df2474,	df2475,	df2476,	df2477,	df2478,	df2479,	df2480,	df2481,	df2482,	df2483,	df2484,	df2485,	df2486,	df2487,	df2488,	df2489,	df2490,	df2491,	df2492,	df2493,	df2494,	df2495,	df2496,	df2497,	df2498,	df2499,	df2500)	

#join6<-rbind(df2501,	df2502,	df2503,	df2504,	df2505,	df2506,	df2507,	df2508,	df2509,	df2510,	df2511,	df2512,	df2513,	df2514,	df2515,	df2516,	df2517,	df2518,	df2519,	df2520,	df2521,	df2522,	df2523,	df2524,	df2525,	df2526,	df2527,	df2528,	df2529,	df2530,	df2531,	df2532,	df2533,	df2534,	df2535,	df2536,	df2537,	df2538,	df2539,	df2540,	df2541,	df2542,	df2543,	df2544,	df2545,	df2546,	df2547,	df2548,	df2549,	df2550,	df2551,	df2552,	df2553,	df2554,	df2555,	df2556,	df2557,	df2558,	df2559,	df2560,	df2561,	df2562,	df2563,	df2564,	df2565,	df2566,	df2567,	df2568,	df2569,	df2570,	df2571,	df2572,	df2573,	df2574,	df2575,	df2576,	df2577,	df2578,	df2579,	df2580,	df2581,	df2582,	df2583,	df2584,	df2585,	df2586,	df2587,	df2588,	df2589,	df2590,	df2591,	df2592,	df2593,	df2594,	df2595,	df2596,	df2597,	df2598,	df2599,	df2600,	df2601,	df2602,	df2603,	df2604,	df2605,	df2606,	df2607,	df2608,	df2609,	df2610,	df2611,	df2612,	df2613,	df2614,	df2615,	df2616,	df2617,	df2618,	df2619,	df2620,	df2621,	df2622,	df2623,	df2624,	df2625,	df2626,	df2627,	df2628,	df2629,	df2630,	df2631,	df2632,	df2633,	df2634,	df2635,	df2636,	df2637,	df2638,	df2639,	df2640,	df2641,	df2642,	df2643,	df2644,	df2645,	df2646,	df2647,	df2648,	df2649,	df2650,	df2651,	df2652,	df2653,	df2654,	df2655,	df2656,	df2657,	df2658,	df2659,	df2660,	df2661,	df2662,	df2663,	df2664,	df2665,	df2666,	df2667,	df2668,	df2669,	df2670,	df2671,	df2672,	df2673,	df2674,	df2675,	df2676,	df2677,	df2678,	df2679,	df2680,	df2681,	df2682,	df2683,	df2684,	df2685,	df2686,	df2687,	df2688,	df2689,	df2690,	df2691,	df2692,	df2693,	df2694,	df2695,	df2696,	df2697,	df2698,	df2699,	df2700,	df2701,	df2702,	df2703,	df2704,	df2705,	df2706,	df2707,	df2708,	df2709,	df2710,	df2711,	df2712,	df2713,	df2714,	df2715,	df2716,	df2717,	df2718,	df2719,	df2720,	df2721,	df2722,	df2723,	df2724,	df2725,	df2726,	df2727,	df2728,	df2729,	df2730,	df2731,	df2732,	df2733,	df2734,	df2735,	df2736,	df2737,	df2738,	df2739,	df2740,	df2741,	df2742,	df2743,	df2744,	df2745,	df2746,	df2747,	df2748,	df2749,	df2750,	df2751,	df2752,	df2753,	df2754,	df2755,	df2756,	df2757,	df2758,	df2759,	df2760,	df2761,	df2762,	df2763,	df2764,	df2765,	df2766,	df2767,	df2768,	df2769,	df2770,	df2771,	df2772,	df2773,	df2774,	df2775,	df2776,	df2777,	df2778,	df2779,	df2780,	df2781,	df2782,	df2783,	df2784,	df2785,	df2786,	df2787,	df2788,	df2789,	df2790,	df2791,	df2792,	df2793,	df2794,	df2795,	df2796,	df2797,	df2798,	df2799,	df2800,	df2801,	df2802,	df2803,	df2804,	df2805,	df2806,	df2807,	df2808,	df2809,	df2810,	df2811,	df2812,	df2813,	df2814,	df2815,	df2816,	df2817,	df2818,	df2819,	df2820,	df2821,	df2822,	df2823,	df2824,	df2825,	df2826,	df2827,	df2828,	df2829,	df2830,	df2831,	df2832,	df2833,	df2834,	df2835,	df2836,	df2837,	df2838,	df2839,	df2840,	df2841,	df2842,	df2843,	df2844,	df2845,	df2846,	df2847,	df2848,	df2849,	df2850,	df2851,	df2852,	df2853,	df2854,	df2855,	df2856,	df2857,	df2858,	df2859,	df2860,	df2861,	df2862,	df2863,	df2864,	df2865,	df2866,	df2867,	df2868,	df2869,	df2870,	df2871,	df2872,	df2873,	df2874,	df2875,	df2876,	df2877,	df2878,	df2879,	df2880,	df2881,	df2882,	df2883,	df2884,	df2885,	df2886,	df2887,	df2888,	df2889,	df2890,	df2891,	df2892,	df2893,	df2894,	df2895,	df2896,	df2897,	df2898,	df2899,	df2900,	df2901,	df2902,	df2903,	df2904,	df2905,	df2906,	df2907,	df2908,	df2909,	df2910,	df2911,	df2912,	df2913,	df2914,	df2915,	df2916,	df2917,	df2918,	df2919,	df2920,	df2921,	df2922,	df2923,	df2924,	df2925,	df2926,	df2927,	df2928,	df2929,	df2930,	df2931,	df2932,	df2933,	df2934,	df2935,	df2936,	df2937,	df2938,	df2939,	df2940,	df2941,	df2942,	df2943,	df2944,	df2945,	df2946,	df2947,	df2948,	df2949,	df2950,	df2951,	df2952,	df2953,	df2954,	df2955,	df2956,	df2957,	df2958,	df2959,	df2960,	df2961,	df2962,	df2963,	df2964,	df2965,	df2966,	df2967,	df2968,	df2969,	df2970,	df2971,	df2972,	df2973,	df2974,	df2975,	df2976,	df2977,	df2978,	df2979,	df2980,	df2981,	df2982,	df2983,	df2984,	df2985,	df2986,	df2987,	df2988,	df2989,	df2990,	df2991,	df2992,	df2993,	df2994,	df2995,	df2996,	df2997,	df2998,	df2999)

#join7<-rbind(df3000,  df3001,	df3002,	df3003,	df3004,	df3005,	df3006,	df3007,	df3008,	df3009,	df3010,	df3011,	df3012,	df3013,	df3014,	df3015,	df3016,	df3017,	df3018,	df3019,	df3020,	df3021,	df3022,	df3023,	df3024,	df3025,	df3026,	df3027,	df3028,	df3029,	df3030,	df3031,	df3032,	df3033,	df3034,	df3035,	df3036,	df3037,	df3038,	df3039,	df3040,	df3041,	df3042,	df3043,	df3044,	df3045,	df3046,	df3047,	df3048,	df3049,	df3050,	df3051,	df3052,	df3053,	df3054,	df3055,	df3056,	df3057,	df3058,	df3059,	df3060,	df3061,	df3062,	df3063,	df3064,	df3065,	df3066,	df3067,	df3068,	df3069,	df3070,	df3071,	df3072,	df3073,	df3074,	df3075,	df3076,	df3077,	df3078,	df3079,	df3080,	df3081,	df3082,	df3083,	df3084,	df3085,	df3086,	df3087,	df3088,	df3089,	df3090,	df3091,	df3092,	df3093,	df3094,	df3095,	df3096,	df3097,	df3098,	df3099,	df3100,	df3101,	df3102,	df3103,	df3104,	df3105,	df3106,	df3107,	df3108,	df3109,	df3110,	df3111,	df3112,	df3113,	df3114,	df3115,	df3116,	df3117,	df3118,	df3119,	df3120,	df3121,	df3122,	df3123,	df3124,	df3125,	df3126,	df3127,	df3128,	df3129,	df3130,	df3131,	df3132,	df3133,	df3134,	df3135,	df3136,	df3137,	df3138,	df3139,	df3140,	df3141,	df3142,	df3143,	df3144,	df3145,	df3146,	df3147,	df3148,	df3149,	df3150,	df3151,	df3152,	df3153,	df3154,	df3155,	df3156,	df3157,	df3158,	df3159,	df3160,	df3161,	df3162,	df3163,	df3164,	df3165,	df3166,	df3167,	df3168,	df3169,	df3170,	df3171,	df3172,	df3173,	df3174,	df3175,	df3176,	df3177,	df3178,	df3179,	df3180,	df3181,	df3182,	df3183,	df3184,	df3185,	df3186,	df3187,	df3188,	df3189,	df3190,	df3191,	df3192,	df3193,	df3194,	df3195,	df3196,	df3197,	df3198,	df3199,	df3200,	df3201,	df3202,	df3203,	df3204,	df3205,	df3206,	df3207,	df3208,	df3209,	df3210,	df3211,	df3212,	df3213,	df3214,	df3215,	df3216,	df3217,	df3218,	df3219,	df3220,	df3221,	df3222,	df3223,	df3224,	df3225,	df3226,	df3227,	df3228,	df3229,	df3230,	df3231,	df3232,	df3233,	df3234,	df3235,	df3236,	df3237,	df3238,	df3239,	df3240,	df3241,	df3242,	df3243,	df3244,	df3245,	df3246,	df3247,	df3248,	df3249,	df3250,	df3251,	df3252,	df3253,	df3254,	df3255,	df3256,	df3257,	df3258,	df3259,	df3260,	df3261,	df3262,	df3263,	df3264,	df3265,	df3266,	df3267,	df3268,	df3269,	df3270,	df3271,	df3272,	df3273,	df3274,	df3275,	df3276,	df3277,	df3278,	df3279,	df3280,	df3281,	df3282,	df3283,	df3284,	df3285,	df3286,	df3287,	df3288,	df3289,	df3290,	df3291,	df3292,	df3293,	df3294,	df3295,	df3296,	df3297,	df3298,	df3299,	df3300,	df3301,	df3302,	df3303,	df3304,	df3305,	df3306,	df3307,	df3308,	df3309,	df3310,	df3311,	df3312,	df3313,	df3314,	df3315,	df3316,	df3317,	df3318,	df3319,	df3320,	df3321,	df3322,	df3323,	df3324,	df3325,	df3326,	df3327,	df3328,	df3329,	df3330,	df3331,	df3332,	df3333,	df3334,	df3335,	df3336,	df3337,	df3338,	df3339,	df3340,	df3341,	df3342,	df3343,	df3344,	df3345,	df3346,	df3347,	df3348,	df3349,	df3350,	df3351,	df3352,	df3353,	df3354,	df3355,	df3356,	df3357,	df3358,	df3359,	df3360,	df3361,	df3362,	df3363,	df3364,	df3365,	df3366,	df3367,	df3368,	df3369,	df3370,	df3371,	df3372,	df3373,	df3374,	df3375,	df3376,	df3377,	df3378,	df3379,	df3380,	df3381,	df3382,	df3383,	df3384,	df3385,	df3386,	df3387,	df3388,	df3389,	df3390,	df3391,	df3392,	df3393,	df3394,	df3395,	df3396,	df3397,	df3398,	df3399,	df3400,	df3401,	df3402,	df3403,	df3404,	df3405,	df3406,	df3407,	df3408,	df3409,	df3410,	df3411,	df3412,	df3413,	df3414,	df3415,	df3416,	df3417,	df3418,	df3419,	df3420,	df3421,	df3422,	df3423,	df3424,	df3425,	df3426,	df3427,	df3428,	df3429,	df3430,	df3431,	df3432,	df3433,	df3434,	df3435,	df3436,	df3437,	df3438,	df3439,	df3440,	df3441,	df3442,	df3443,	df3444,	df3445,	df3446,	df3447,	df3448,	df3449,	df3450,	df3451,	df3452,	df3453,	df3454,	df3455,	df3456,	df3457,	df3458,	df3459,	df3460,	df3461,	df3462,	df3463,	df3464,	df3465,	df3466,	df3467,	df3468,	df3469,	df3470,	df3471,	df3472,	df3473,	df3474,	df3475,	df3476,	df3477,	df3478,	df3479,	df3480,	df3481,	df3482,	df3483,	df3484,	df3485,	df3486,	df3487,	df3488,	df3489,	df3490,	df3491,	df3492,	df3493,	df3494,	df3495,	df3496,	df3497,	df3498,	df3499)

#join8<-rbind(df3500,  df3501,	df3502,	df3503,	df3504,	df3505,	df3506,	df3507,	df3508,	df3509,	df3510,	df3511,	df3512,	df3513,	df3514,	df3515,	df3516,	df3517,	df3518,	df3519,	df3520,	df3521,	df3522,	df3523,	df3524,	df3525,	df3526,	df3527,	df3528,	df3529,	df3530,	df3531,	df3532,	df3533,	df3534,	df3535,	df3536,	df3537,	df3538,	df3539,	df3540,	df3541,	df3542,	df3543,	df3544,	df3545,	df3546,	df3547,	df3548,	df3549,	df3550,	df3551,	df3552,	df3553,	df3554,	df3555,	df3556,	df3557,	df3558,	df3559,	df3560,	df3561,	df3562,	df3563,	df3564,	df3565,	df3566,	df3567,	df3568,	df3569,	df3570,	df3571,	df3572,	df3573,	df3574,	df3575,	df3576,	df3577,	df3578,	df3579,	df3580,	df3581,	df3582,	df3583,	df3584,	df3585,	df3586,	df3587,	df3588,	df3589,	df3590,	df3591,	df3592,	df3593,	df3594,	df3595,	df3596,	df3597,	df3598,	df3599,	df3600,	df3601,	df3602,	df3603,	df3604,	df3605,	df3606,	df3607,	df3608,	df3609,	df3610,	df3611,	df3612,	df3613,	df3614,	df3615,	df3616,	df3617,	df3618,	df3619,	df3620,	df3621,	df3622,	df3623,	df3624,	df3625,	df3626,	df3627,	df3628,	df3629,	df3630,	df3631,	df3632,	df3633,	df3634,	df3635,	df3636,	df3637,	df3638,	df3639,	df3640,	df3641,	df3642,	df3643,	df3644,	df3645,	df3646,	df3647,	df3648,	df3649,	df3650,	df3651,	df3652,	df3653,	df3654,	df3655,	df3656,	df3657,	df3658,	df3659,	df3660,	df3661,	df3662,	df3663,	df3664,	df3665,	df3666,	df3667,	df3668,	df3669,	df3670,	df3671,	df3672,	df3673,	df3674,	df3675,	df3676,	df3677,	df3678,	df3679,	df3680,	df3681,	df3682,	df3683,	df3684,	df3685,	df3686,	df3687,	df3688,	df3689,	df3690,	df3691,	df3692,	df3693,	df3694,	df3695,	df3696,	df3697,	df3698,	df3699,	df3700,	df3701,	df3702,	df3703,	df3704,	df3705,	df3706,	df3707,	df3708,	df3709,	df3710,	df3711,	df3712,	df3713,	df3714,	df3715,	df3716,	df3717,	df3718,	df3719,	df3720,	df3721,	df3722,	df3723,	df3724,	df3725,	df3726,	df3727,	df3728,	df3729,	df3730,	df3731,	df3732,	df3733,	df3734,	df3735,	df3736,	df3737,	df3738,	df3739,	df3740,	df3741,	df3742,	df3743,	df3744,	df3745,	df3746,	df3747,	df3748,	df3749,	df3750,	df3751,	df3752,	df3753,	df3754,	df3755,	df3756,	df3757,	df3758,	df3759,	df3760,	df3761,	df3762,	df3763,	df3764,	df3765,	df3766,	df3767,	df3768,	df3769,	df3770,	df3771,	df3772,	df3773,	df3774,	df3775,	df3776,	df3777,	df3778,	df3779,	df3780,	df3781,	df3782,	df3783,	df3784,	df3785,	df3786,	df3787,	df3788,	df3789,	df3790,	df3791,	df3792,	df3793,	df3794,	df3795,	df3796,	df3797,	df3798,	df3799,	df3800,	df3801,	df3802,	df3803,	df3804,	df3805,	df3806,	df3807,	df3808,	df3809,	df3810,	df3811,	df3812,	df3813,	df3814,	df3815,	df3816,	df3817,	df3818,	df3819,	df3820,	df3821,	df3822,	df3823,	df3824,	df3825,	df3826,	df3827,	df3828,	df3829,	df3830,	df3831,	df3832,	df3833,	df3834,	df3835,	df3836,	df3837,	df3838,	df3839,	df3840,	df3841,	df3842,	df3843,	df3844,	df3845,	df3846,	df3847,	df3848,	df3849,	df3850,	df3851,	df3852,	df3853,	df3854,	df3855,	df3856,	df3857,	df3858,	df3859,	df3860,	df3861,	df3862,	df3863,	df3864,	df3865,	df3866,	df3867,	df3868,	df3869,	df3870,	df3871,	df3872,	df3873,	df3874,	df3875,	df3876,	df3877,	df3878,	df3879,	df3880,	df3881,	df3882,	df3883,	df3884,	df3885,	df3886,	df3887,	df3888,	df3889,	df3890,	df3891,	df3892,	df3893,	df3894,	df3895,	df3896,	df3897,	df3898,	df3899,	df3900,	df3901,	df3902,	df3903,	df3904,	df3905,	df3906,	df3907,	df3908,	df3909,	df3910,	df3911,	df3912,	df3913,	df3914,	df3915,	df3916,	df3917,	df3918,	df3919,	df3920,	df3921,	df3922,	df3923,	df3924,	df3925,	df3926,	df3927,	df3928,	df3929,	df3930,	df3931,	df3932,	df3933,	df3934,	df3935,	df3936,	df3937,	df3938,	df3939,	df3940,	df3941,	df3942,	df3943,	df3944,	df3945,	df3946,	df3947,	df3948,	df3949,	df3950,	df3951,	df3952,	df3953,	df3954,	df3955,	df3956,	df3957,	df3958,	df3959,	df3960,	df3961,	df3962,	df3963,	df3964,	df3965,	df3966,	df3967,	df3968,	df3969,	df3970,	df3971,	df3972,	df3973,	df3974,	df3975,	df3976,	df3977,	df3978,	df3979,	df3980,	df3981,	df3982,	df3983,	df3984,	df3985,	df3986,	df3987,	df3988,	df3989,	df3990,	df3991,	df3992,	df3993,	df3994,	df3995,	df3996,	df3997,	df3998,	df3999)  

#join9<-rbind(df4000,  df4001,	df4002,	df4003,	df4004,	df4005,	df4006,	df4007,	df4008,	df4009,	df4010,	df4011,	df4012,	df4013,	df4014,	df4015,	df4016,	df4017,	df4018,	df4019,	df4020,	df4021,	df4022,	df4023,	df4024,	df4025,	df4026,	df4027,	df4028,	df4029,	df4030,	df4031,	df4032,	df4033,	df4034,	df4035,	df4036,	df4037,	df4038,	df4039,	df4040,	df4041,	df4042,	df4043,	df4044,	df4045,	df4046,	df4047,	df4048,	df4049,	df4050,	df4051,	df4052,	df4053,	df4054,	df4055,	df4056,	df4057,	df4058,	df4059,	df4060,	df4061,	df4062,	df4063,	df4064,	df4065,	df4066,	df4067,	df4068,	df4069,	df4070,	df4071,	df4072,	df4073,	df4074,	df4075,	df4076,	df4077,	df4078,	df4079,	df4080,	df4081,	df4082,	df4083,	df4084,	df4085,	df4086,	df4087,	df4088,	df4089,	df4090,	df4091,	df4092,	df4093,	df4094,	df4095,	df4096,	df4097,	df4098,	df4099,	df4100,	df4101,	df4102,	df4103,	df4104,	df4105,	df4106,	df4107,	df4108,	df4109,	df4110,	df4111,	df4112,	df4113,	df4114,	df4115,	df4116,	df4117,	df4118,	df4119,	df4120,	df4121,	df4122,	df4123,	df4124,	df4125,	df4126,	df4127,	df4128,	df4129,	df4130,	df4131,	df4132,	df4133,	df4134,	df4135,	df4136,	df4137,	df4138,	df4139,	df4140,	df4141,	df4142,	df4143,	df4144,	df4145,	df4146,	df4147,	df4148,	df4149,	df4150,	df4151,	df4152,	df4153,	df4154,	df4155,	df4156,	df4157,	df4158,	df4159,	df4160,	df4161,	df4162,	df4163,	df4164,	df4165,	df4166,	df4167,	df4168,	df4169,	df4170,	df4171,	df4172,	df4173,	df4174,	df4175,	df4176,	df4177,	df4178,	df4179,	df4180,	df4181,	df4182,	df4183,	df4184,	df4185,	df4186,	df4187,	df4188,	df4189,	df4190,	df4191,	df4192,	df4193,	df4194,	df4195,	df4196,	df4197,	df4198,	df4199,	df4200,	df4201,	df4202,	df4203,	df4204,	df4205,	df4206,	df4207,	df4208,	df4209,	df4210,	df4211,	df4212,	df4213,	df4214,	df4215,	df4216,	df4217,	df4218,	df4219,	df4220,	df4221,	df4222,	df4223,	df4224,	df4225,	df4226,	df4227,	df4228,	df4229,	df4230,	df4231,	df4232,	df4233,	df4234,	df4235,	df4236,	df4237,	df4238,	df4239,	df4240,	df4241,	df4242,	df4243,	df4244,	df4245,	df4246,	df4247,	df4248,	df4249,	df4250,	df4251,	df4252,	df4253,	df4254,	df4255,	df4256,	df4257,	df4258,	df4259,	df4260,	df4261,	df4262,	df4263,	df4264,	df4265,	df4266,	df4267,	df4268,	df4269,	df4270,	df4271,	df4272,	df4273,	df4274,	df4275,	df4276,	df4277,	df4278,	df4279,	df4280,	df4281,	df4282,	df4283,	df4284,	df4285,	df4286,	df4287,	df4288,	df4289,	df4290,	df4291,	df4292,	df4293,	df4294,	df4295,	df4296,	df4297,	df4298,	df4299,	df4300,	df4301,	df4302,	df4303,	df4304,	df4305,	df4306,	df4307,	df4308,	df4309,	df4310,	df4311,	df4312,	df4313,	df4314,	df4315,	df4316,	df4317,	df4318,	df4319,	df4320,	df4321,	df4322,	df4323,	df4324,	df4325,	df4326,	df4327,	df4328,	df4329,	df4330,	df4331,	df4332,	df4333,	df4334,	df4335,	df4336,	df4337,	df4338,	df4339,	df4340,	df4341,	df4342,	df4343,	df4344,	df4345,	df4346,	df4347,	df4348,	df4349,	df4350,	df4351,	df4352,	df4353,	df4354,	df4355,	df4356,	df4357,	df4358,	df4359,	df4360,	df4361,	df4362,	df4363,	df4364,	df4365,	df4366,	df4367,	df4368,	df4369,	df4370,	df4371,	df4372,	df4373,	df4374,	df4375,	df4376,	df4377,	df4378,	df4379,	df4380,	df4381,	df4382,	df4383,	df4384,	df4385,	df4386,	df4387,	df4388,	df4389,	df4390,	df4391,	df4392,	df4393,	df4394,	df4395,	df4396,	df4397,	df4398,	df4399,	df4400,	df4401,	df4402,	df4403,	df4404,	df4405,	df4406,	df4407,	df4408,	df4409,	df4410,	df4411,	df4412,	df4413,	df4414,	df4415,	df4416,	df4417,	df4418,	df4419,	df4420,	df4421,	df4422,	df4423,	df4424,	df4425,	df4426,	df4427,	df4428,	df4429,	df4430,	df4431,	df4432,	df4433,	df4434,	df4435,	df4436,	df4437,	df4438)

coef_plausible_model<-rbind(join) #,join2,join3,join4,join5,join6,join7,join8,join9,join10)   
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
## Mean using excel by removing numbers from the first column

#######################################################################################################################################################################
## HEIGHT
data<-read.table("Model_Selection_Landscape_5kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Height==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.5275
data2<-subset(data2, data2$abRR<1.5275)

## Correlations
correlations<-subset(data2, select=Cover_5:Ratio_5)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_5,data2$Time, method="spearman")
cor(data2$Iso_5,data2$Time, method="spearman")
cor(data2$MPS_5,data2$Time, method="spearman")
cor(data2$LPS_5,data2$Time, method="spearman")
cor(data2$Ratio_5,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_5+Ratio_5+LPS_5+MPS_5+Iso_5, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
#coef<-list()
#r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m3<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m4<-glm(abRR~Time, data=data3, Gamma("identity"))
  m5<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m6<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m8<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m9<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m10<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m11<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m14<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m15<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m16<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m17<-glm(abRR~Cover_5, data=data3, Gamma("identity"))
  m18<-glm(abRR~Disturbance+Cover_5, data=data3, Gamma("identity"))
  m19<-glm(abRR~Activity+Cover_5, data=data3, Gamma("identity"))
  m20<-glm(abRR~Time+Cover_5, data=data3, Gamma("identity"))
  m21<-glm(abRR~Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m22<-glm(abRR~Disturbance+Activity+Cover_5, data=data3, Gamma("identity"))
  m23<-glm(abRR~Disturbance+Time+Cover_5, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m25<-glm(abRR~Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m26<-glm(abRR~Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m27<-glm(abRR~Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m28<-glm(abRR~Disturbance+Activity+Time+Cover_5, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m31<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m32<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_5, data=data3, Gamma("identity"))
  m33<-glm(abRR~Iso_5, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Iso_5, data=data3, Gamma("identity"))
  m35<-glm(abRR~Activity+Iso_5, data=data3, Gamma("identity"))
  m36<-glm(abRR~Time+Iso_5, data=data3, Gamma("identity"))
  m37<-glm(abRR~Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m38<-glm(abRR~Disturbance+Activity+Iso_5, data=data3, Gamma("identity"))
  m39<-glm(abRR~Disturbance+Time+Iso_5, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m41<-glm(abRR~Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m42<-glm(abRR~Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m43<-glm(abRR~Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m44<-glm(abRR~Disturbance+Activity+Time+Iso_5, data=data3, Gamma("identity"))
  m45<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m46<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m47<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_5, data=data3, Gamma("identity"))
  m49<-glm(abRR~Ratio_5, data=data3, Gamma("identity"))
  m50<-glm(abRR~Disturbance+Ratio_5, data=data3, Gamma("identity"))
  m51<-glm(abRR~Activity+Ratio_5, data=data3, Gamma("identity"))
  m52<-glm(abRR~Time+Ratio_5, data=data3, Gamma("identity"))
  m53<-glm(abRR~Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Activity+Ratio_5, data=data3, Gamma("identity"))
  m55<-glm(abRR~Disturbance+Time+Ratio_5, data=data3, Gamma("identity"))
  m56<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m57<-glm(abRR~Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m58<-glm(abRR~Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m59<-glm(abRR~Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Activity+Time+Ratio_5, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m62<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m64<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_5, data=data3, Gamma("identity"))
  m65<-glm(abRR~LPS_5, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+LPS_5, data=data3, Gamma("identity"))
  m67<-glm(abRR~Activity+LPS_5, data=data3, Gamma("identity"))
  m68<-glm(abRR~Time+LPS_5, data=data3, Gamma("identity"))
  m69<-glm(abRR~Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Activity+LPS_5, data=data3, Gamma("identity"))
  m71<-glm(abRR~Disturbance+Time+LPS_5, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m73<-glm(abRR~Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m74<-glm(abRR~Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m75<-glm(abRR~Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Activity+Time+LPS_5, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m79<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m80<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_5, data=data3, Gamma("identity"))
  m81<-glm(abRR~MPS_5, data=data3, Gamma("identity"))
  m82<-glm(abRR~Disturbance+MPS_5, data=data3, Gamma("identity"))
  m83<-glm(abRR~Activity+MPS_5, data=data3, Gamma("identity"))
  m84<-glm(abRR~Time+MPS_5, data=data3, Gamma("identity"))
  m85<-glm(abRR~Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m86<-glm(abRR~Disturbance+Activity+MPS_5, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Time+MPS_5, data=data3, Gamma("identity"))
  m88<-glm(abRR~Disturbance+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m89<-glm(abRR~Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m90<-glm(abRR~Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m91<-glm(abRR~Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m92<-glm(abRR~Disturbance+Activity+Time+MPS_5, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m95<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  m96<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_5, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  #coef[[i]]<-list(m)
  #r2[[i]]<-r.squaredLR(m, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
#sink("R2.txt") 
#lapply(r2, print) 
#sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

#######################################################################################################################################################################
## LITTER
data<-read.table("Model_Selection_Landscape_100kmradius_restored.txt", header=T, sep="\t")

## Data
data<-subset(data, data$Litter==1)
data2<-na.omit(data)

## Remove outlier values (dependent variable)
outlyers<-boxplot(data2$abRR)
sort(outlyers$out) # 1.3218
data2<-subset(data2, data2$abRR<1.3218)

## Correlations 
correlations<-subset(data2, select=Cover_100:Ratio_100)
cor(correlations, method="spearman", use="pairwise.complete.obs")
cor(data2$Cover_100,data2$Time, method="spearman")
cor(data2$Iso_100,data2$Time, method="spearman")
cor(data2$MPS_100,data2$Time, method="spearman")
cor(data2$LPS_100,data2$Time, method="spearman")
cor(data2$Ratio_100,data2$Time, method="spearman")

## Good of fitness and normality
data2$abRR<-data2$abRR+0.5
global.model<-glm(abRR~Biogeographic_realm+Disturbance+Activity+Time+Cover_100+Ratio_100+LPS_100+MPS_100+Iso_100, data=data2, Gamma("identity"))
plot(global.model)
hist(resid(global.model), breaks=20)

## Run models via bootstrap
top_ranked<-list()
null_model_AICc<-list()
null_model_position<-list()
coef<-list()
r2<-list()
for (i in 1:100){
  ## Sample 1 data per study
  data3<-ddply(data2,.(Site),randomRows,1)
  
  m1<-glm(abRR~1, data=data3, Gamma("identity"))
  m2<-glm(abRR~Disturbance+Biogeographic_realm, data=data3, Gamma("identity"))
  m3<-glm(abRR~Time+Ratio_100, data=data3, Gamma("identity"))
  m4<-glm(abRR~Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m5<-glm(abRR~Disturbance+Activity+Ratio_100, data=data3, Gamma("identity"))
  m6<-glm(abRR~Disturbance+Time+Ratio_100, data=data3, Gamma("identity"))
  m7<-glm(abRR~Disturbance+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m8<-glm(abRR~Activity+Time+Ratio_100, data=data3, Gamma("identity"))
  m9<-glm(abRR~Activity+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m10<-glm(abRR~Activity+Time, data=data3, Gamma("identity"))
  m11<-glm(abRR~Time+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m12<-glm(abRR~Disturbance+Activity+Time+Ratio_100, data=data3, Gamma("identity"))
  m13<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m14<-glm(abRR~Disturbance+Time+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m15<-glm(abRR~Activity+Time+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m16<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Ratio_100, data=data3, Gamma("identity"))
  m17<-glm(abRR~LPS_100, data=data3, Gamma("identity"))
  m18<-glm(abRR~Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m19<-glm(abRR~Disturbance+LPS_100, data=data3, Gamma("identity"))
  m20<-glm(abRR~Activity+LPS_100, data=data3, Gamma("identity"))
  m21<-glm(abRR~Time+LPS_100, data=data3, Gamma("identity"))
  m22<-glm(abRR~Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m23<-glm(abRR~Disturbance+Activity+LPS_100, data=data3, Gamma("identity"))
  m24<-glm(abRR~Disturbance+Time+LPS_100, data=data3, Gamma("identity"))
  m25<-glm(abRR~Disturbance+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m26<-glm(abRR~Activity+Time+LPS_100, data=data3, Gamma("identity"))
  m27<-glm(abRR~Activity+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m28<-glm(abRR~Time+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m29<-glm(abRR~Disturbance+Activity+Time+LPS_100, data=data3, Gamma("identity"))
  m30<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m31<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m32<-glm(abRR~Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m33<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m34<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_100, data=data3, Gamma("identity"))
  m35<-glm(abRR~MPS_100, data=data3, Gamma("identity"))
  m36<-glm(abRR~Disturbance+MPS_100, data=data3, Gamma("identity"))
  m37<-glm(abRR~Activity+MPS_100, data=data3, Gamma("identity"))
  m38<-glm(abRR~Time+MPS_100, data=data3, Gamma("identity"))
  m39<-glm(abRR~Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m40<-glm(abRR~Disturbance+Activity+MPS_100, data=data3, Gamma("identity"))
  m41<-glm(abRR~Disturbance+Time+MPS_100, data=data3, Gamma("identity"))
  m42<-glm(abRR~Disturbance+Activity+Time, data=data3, Gamma("identity"))
  m43<-glm(abRR~Disturbance+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m44<-glm(abRR~Activity+Time+MPS_100, data=data3, Gamma("identity"))
  m45<-glm(abRR~Activity+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m46<-glm(abRR~Time+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m47<-glm(abRR~Disturbance+Activity+Time+MPS_100, data=data3, Gamma("identity"))
  m48<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m49<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m50<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m51<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_100, data=data3, Gamma("identity"))
  m52<-glm(abRR~Disturbance+Activity+Biogeographic_realm, data=data3, Gamma("identity"))
  m53<-glm(abRR~Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m54<-glm(abRR~Disturbance+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m55<-glm(abRR~Activity+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m56<-glm(abRR~Time+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m57<-glm(abRR~Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m58<-glm(abRR~Disturbance+Activity+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m59<-glm(abRR~Disturbance, data=data3, Gamma("identity"))
  m60<-glm(abRR~Disturbance+Time+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m61<-glm(abRR~Disturbance+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m62<-glm(abRR~Activity+Time+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m63<-glm(abRR~Activity+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m64<-glm(abRR~Time+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m65<-glm(abRR~Disturbance+Activity+Time+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m66<-glm(abRR~Disturbance+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m67<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m68<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m69<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m70<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_100+Ratio_100, data=data3, Gamma("identity"))
  m71<-glm(abRR~Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m72<-glm(abRR~Disturbance+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m73<-glm(abRR~Activity+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m74<-glm(abRR~Time+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m75<-glm(abRR~Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m76<-glm(abRR~Disturbance+Activity+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m77<-glm(abRR~Disturbance+Time+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m78<-glm(abRR~Disturbance+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m79<-glm(abRR~Activity+Time+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m80<-glm(abRR~Activity+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m81<-glm(abRR~Time+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m82<-glm(abRR~Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m83<-glm(abRR~Disturbance+Activity+Time+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m84<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m85<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m86<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m87<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_100+Ratio_100, data=data3, Gamma("identity"))
  m88<-glm(abRR~LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m89<-glm(abRR~Disturbance+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m90<-glm(abRR~Activity+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m91<-glm(abRR~Time+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m92<-glm(abRR~Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m93<-glm(abRR~Disturbance+Activity+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m94<-glm(abRR~Disturbance+Time+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m95<-glm(abRR~Disturbance+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m96<-glm(abRR~Activity+Time+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m97<-glm(abRR~Activity+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m98<-glm(abRR~Time+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m99<-glm(abRR~Disturbance+Activity+Time+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m100<-glm(abRR~Disturbance+Activity+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m101<-glm(abRR~Disturbance+Time+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m102<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm, data=data3, Gamma("identity"))
  m103<-glm(abRR~Activity+Time+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m104<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+LPS_100+Ratio_100, data=data3, Gamma("identity"))
  m105<-glm(abRR~MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m106<-glm(abRR~Disturbance+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m107<-glm(abRR~Activity+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m108<-glm(abRR~Time+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m109<-glm(abRR~Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m110<-glm(abRR~Disturbance+Activity+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m111<-glm(abRR~Disturbance+Time+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m112<-glm(abRR~Disturbance+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m113<-glm(abRR~Activity+Time+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m114<-glm(abRR~Activity, data=data3, Gamma("identity"))
  m115<-glm(abRR~Activity+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m116<-glm(abRR~Time+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m117<-glm(abRR~Disturbance+Activity+Time+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m118<-glm(abRR~Disturbance+Activity+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m119<-glm(abRR~Disturbance+Time+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m120<-glm(abRR~Activity+Time+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m121<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+MPS_100+Ratio_100, data=data3, Gamma("identity"))
  m122<-glm(abRR~Cover_100, data=data3, Gamma("identity"))
  m123<-glm(abRR~Disturbance+Cover_100, data=data3, Gamma("identity"))
  m124<-glm(abRR~Activity+Cover_100, data=data3, Gamma("identity"))
  m125<-glm(abRR~Time+Cover_100, data=data3, Gamma("identity"))
  m126<-glm(abRR~Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m127<-glm(abRR~Disturbance+Activity+Cover_100, data=data3, Gamma("identity"))
  m128<-glm(abRR~Time, data=data3, Gamma("identity"))
  m129<-glm(abRR~Disturbance+Time+Cover_100, data=data3, Gamma("identity"))
  m130<-glm(abRR~Disturbance+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m131<-glm(abRR~Activity+Time+Cover_100, data=data3, Gamma("identity"))
  m132<-glm(abRR~Activity+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m133<-glm(abRR~Time+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m134<-glm(abRR~Disturbance+Activity+Time+Cover_100, data=data3, Gamma("identity"))
  m135<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m136<-glm(abRR~Disturbance+Time+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m137<-glm(abRR~Activity+Time+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m138<-glm(abRR~Biogeographic_realm, data=data3, Gamma("identity"))
  m139<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Cover_100, data=data3, Gamma("identity"))
  m140<-glm(abRR~Iso_100, data=data3, Gamma("identity"))
  m141<-glm(abRR~Disturbance+Iso_100, data=data3, Gamma("identity"))
  m142<-glm(abRR~Activity+Iso_100, data=data3, Gamma("identity"))
  m143<-glm(abRR~Time+Iso_100, data=data3, Gamma("identity"))
  m144<-glm(abRR~Disturbance+Activity, data=data3, Gamma("identity"))
  m145<-glm(abRR~Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m146<-glm(abRR~Disturbance+Activity+Iso_100, data=data3, Gamma("identity"))
  m147<-glm(abRR~Disturbance+Time+Iso_100, data=data3, Gamma("identity"))
  m148<-glm(abRR~Disturbance+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m149<-glm(abRR~Activity+Time+Iso_100, data=data3, Gamma("identity"))
  m150<-glm(abRR~Activity+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m151<-glm(abRR~Time+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m152<-glm(abRR~Disturbance+Time, data=data3, Gamma("identity"))
  m153<-glm(abRR~Disturbance+Activity+Time+Iso_100, data=data3, Gamma("identity"))
  m154<-glm(abRR~Disturbance+Activity+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m155<-glm(abRR~Disturbance+Time+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m156<-glm(abRR~Activity+Time+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m157<-glm(abRR~Disturbance+Activity+Time+Biogeographic_realm+Iso_100, data=data3, Gamma("identity"))
  m158<-glm(abRR~Ratio_100, data=data3, Gamma("identity"))
  m159<-glm(abRR~Disturbance+Ratio_100, data=data3, Gamma("identity"))
  m160<-glm(abRR~Activity+Ratio_100, data=data3, Gamma("identity"))
  
  ranks<-m.AICc(list(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,m40,m41,m42,m43,m44,m45,m46,m47,m48,m49,m50,m51,m52,m53,m54,m55,m56,m57,m58,m59,m60,m61,m62,m63,m64,m65,m66,m67,m68,m69,m70,m71,m72,m73,m74,m75,m76,m77,m78,m79,m80,m81,m82,m83,m84,m85,m86,m87,m88,m89,m90,m91,m92,m93,m94,m95,m96,m97,m98,m99,m100,m101,m102,m103,m104,m105,m106,m107,m108,m109,m110,m111,m112,m113,m114,m115,m116,m117,m118,m119,m120,m121,m122,m123,m124,m125,m126,m127,m128,m129,m130,m131,m132,m133,m134,m135,m136,m137,m138,m139,m140,m141,m142,m143,m144,m145,m146,m147,m148,m149,m150,m151,m152,m153,m154,m155,m156,m157,m158,m159,m160),as.integer(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160")),length(data3$abRR))
  
  top_ranked[[i]]<-ranks[1,]
  null_model_AICc[[i]]<-ranks[ranks$name=="1",]
  null_model_position[[i]]<-which(ranks$name=="1",)
  coef[[i]]<-list(summary(m17))
  r2[[i]]<-r.squaredLR(m17, null = m1)
}

## Transforming lists in data.frames
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_top_ranked<-data.frame(matrix(unlist(top_ranked), nrow=100, byrow=T))
df_null_model_AICc<-data.frame(matrix(unlist(null_model_AICc), nrow=100, byrow=T))
df_null_model_position<-data.frame(matrix(unlist(null_model_position), nrow=100, byrow=T))

## Saving data.frames
write.table(df_top_ranked, "Top_ranked.txt",quote=F)
write.table(df_null_model_AICc, "Null_model_AICc.txt",quote=F)
write.table(df_null_model_position, "Null_model_position.txt",quote=F)
sink("Coefficients.txt") 
lapply(coef, print) 
sink() 
sink("R2.txt") 
lapply(r2, print) 
sink() 

## Top-model frequence
plausible_mod_frequency<-as.data.frame(ftable(df_top_ranked[,7]))
plausible_mod_table_AICc<-aggregate(df_top_ranked, list(df_top_ranked[,7]), mean)
plausible_Null_table_AICc<-aggregate(df_null_model_AICc, list(df_null_model_AICc[,7]), mean)

## Saving data.frames
write.table(plausible_mod_frequency, "Plausible_mod_frequency.txt",quote=F, sep="\t")
write.table(plausible_mod_table_AICc, "Plausible_mod_table_AICc_mean.txt",quote=F, sep="\t")
write.table(plausible_Null_table_AICc, "Plausible_Null_table_AICc_mean.txt",quote=F, sep="\t")

## R2 values for top-ranked model
r2_estimate<-list()
for(i in 1:100){
  r2<-r2
  df<-data.frame(r2[[i]][1])
  r2_estimate[[i]]<-df[,1]
}
df_r2_estimate<-data.frame(matrix(unlist(r2_estimate), nrow=100, byrow=T))
r2_table<-cbind(df_top_ranked[,7],r2_estimate)
r2_plausible_model<-subset(r2_table, r2_table[,1]==17) 
write.table(r2_plausible_model, "m.r2_plausible_model.txt", quote=F, sep="\t")

## Coeficient values for top-ranked model
Coef_estimate<-list()
Coef_se<-list()
for(i in 1:100){
  coef<-coef
  df<-data.frame(coef[[i]][[1]][12]) 
  Coef_estimate[[i]]<-df[,1]
  Coef_se[[i]]<-df[,2]
}
df_Coef_estimate<-data.frame(matrix(unlist(Coef_estimate), nrow=100, byrow=T))
df_Coef_se<-data.frame(matrix(unlist(Coef_se), nrow=100, byrow=T))
Coef_estimate_se<-cbind(df_Coef_estimate,df_Coef_se)
coef_table<-cbind(df_top_ranked[,7],Coef_estimate_se)
coef_plausible_model<-subset(coef_table, coef_table[,1]==17) 
write.table(coef_plausible_model, "m.Coef_plausible_model.txt", quote=F, sep="\t")
coef_plausible_model_mean<-as.data.frame(apply(coef_plausible_model, 2, mean))
write.table(coef_plausible_model_mean, "m.Coef_plausible_model_mean.txt", quote=F, sep="\t")
